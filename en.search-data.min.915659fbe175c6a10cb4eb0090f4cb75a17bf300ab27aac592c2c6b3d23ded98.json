[{"id":0,"href":"/Programming-Notes/docs/notes/","title":"Introduction","section":"Docs","content":"è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« #\r"},{"id":1,"href":"/Programming-Notes/docs/notes/zig/zig-grammar/","title":"Zig Grammar","section":"Zig","content":"zig è¯­æ³•#\ræµç¨‹æ§åˆ¶#\rif#\rifå¯ç”¨æ¥è§£åŒ…å¯é€‰ç±»å‹(?) ä¸ é”™è¯¯ç±»å‹(!)\nconst optional:?i32 = null; if (optional) |number:i32| { //something todo } const error: anyerror!i32 = 0; if (error) |number:i32| { //something todo }é«˜çº§ç±»å‹#\ræŒ‡é’ˆ#\rå•é¡¹æŒ‡é’ˆ#\rå•é¡¹æŒ‡é’ˆæŒ‡å‘å•ä¸ªå…ƒç´ ã€‚\nå•é¡¹æŒ‡é’ˆçš„ç±»å‹ä¸ºÂ *Tï¼Œå…¶ä¸­Â TÂ æ˜¯æ‰€æŒ‡å‘çš„æ•°æ®ç±»å‹ã€‚è§£å¼•ç”¨æ“ä½œä½¿ç”¨Â ptr.*ã€‚\n// ä»£ç æ¥è‡ª zig è¯­è¨€åœ£ç» const print = @import(\u0026#34;std\u0026#34;).debug.print; pub fn main() !void { var integer: i16 = 666; const ptr = \u0026amp;integer; ptr.* = ptr.* + 1; print(\u0026#34;{}\\n\u0026#34;, .{integer}); }å¤šé¡¹æŒ‡é’ˆ#\rå¤šé¡¹æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæˆ–å¤šä¸ªè¿ç»­çš„å…ƒç´ ï¼Œä½†å…¶æ•°é‡åœ¨ç¼–è¯‘æœŸæ˜¯æœªçŸ¥çš„ã€‚ TIP\nå¤šé¡¹æŒ‡é’ˆçš„ç±»å‹ä¸ºÂ [*]Tï¼Œå…¶ä¸­Â TÂ æ˜¯æ‰€æŒ‡å‘çš„æ•°æ®ç±»å‹ï¼Œä¸”Â TÂ çš„å¤§å°å¿…é¡»æ˜¯æ˜ç¡®çš„ï¼ˆè¿™æ„å‘³ç€å®ƒä¸èƒ½æ˜¯Â anyopaqueÂ æˆ–å…¶ä»–ä¸é€æ˜ç±»å‹ï¼‰\nconst print = @import(\u0026#34;std\u0026#34;).debug.print; pub fn main() !void { const array = [_]i32{ 1, 2, 3, 4 }; const ptr: [*]const i32 = \u0026amp;array; print(\u0026#34;ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š{}\\n\u0026#34;, .{ptr[0]}); }å¤šä¸ªæŒ‡é’ˆçš„åŒºåˆ«#\r[4] const u8 // è¯¥ç±»å‹è¡¨ç¤ºä¸€ä¸ªé•¿åº¦ä¸º4çš„æ•°ç»„ï¼Œé‡Œé¢çš„ç±»å‹ [] const u8 // è¿™è¡¨ç¤ºæ˜¯ä¸€ä¸ª å†…éƒ¨ç±»å‹ä¸º const u8 çš„åˆ‡ç‰‡ *[4] const u8 // è¡¨ç¤ºä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆçš„åœ°å€å­˜å‚¨ä¸€ä¸ªé•¿åº¦ä¸º4ï¼Œå…ƒç´ ä¸ºconst u8çš„æ•°ç»„ *[] const u8 //è¿™è¡¨ç¤ºæŒ‡é’ˆåœ°å€å­˜å‚¨ç€ä¸€ä¸ªåˆ‡ç‰‡ [*] const u8 // è¡¨ç¤ºä¸€ä¸ªå¤šé¡¹æŒ‡é’ˆ å…ƒç´ ä¸ºconst u8 ä½†æ˜¯é•¿åº¦æœªçŸ¥åˆ‡ç‰‡ä¸æ•°ç»„#\råˆ‡ç‰‡#\råˆ‡ç‰‡æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªèƒ–æŒ‡é’ˆï¼Œå†…éƒ¨æœ‰ä¸€ä¸ª[*] Tçš„å¤šé¡¹æŒ‡é’ˆä¸åˆ‡ç‰‡é•¿åº¦ã€‚\nconst array: [_] i32 = [_]i32{1,2,3,4}; const slice:[] i32 = array[0..4];è”åˆç±»å‹#\runionä¸tag union#\runion { int:i32, float:f32 };unionçš„ç¼ºé™·æ˜¯ä»–ä¸çŸ¥é“è‡ªå·±å­˜å‚¨çš„æ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®ã€‚è€Œtag unionå°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚\nunion(enum) { a:i32, b:f32, };opaque é€æ˜ç±»å‹#\rNOTE\nå‡ ä¹ç”¨ä¸åˆ°çš„ç±»å‹ï¼Œè¿™é€šå¸¸ç”¨äºä¸ C ä»£ç äº¤äº’æ—¶ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ï¼Œå°¤å…¶æ˜¯åœ¨ C ä»£ç æ²¡æœ‰å…¬å¼€ç»“æ„ä½“ç»†èŠ‚çš„æƒ…å†µä¸‹ã€‚\nconst wat = opauqe {};ä¸Cäº¤äº’#\rå¼•å…¥Cå¤´æ–‡ä»¶#\rconst c = @import({ @cDefine(\u0026#34;_NO_CRT_STDIN_INLINE\u0026#34;,\u0026#34;1\u0026#34;); @cInclude(\u0026#34;stdio.h\u0026#34;); })å¼•å…¥ vcpkg#\rå£°æ˜Cå‡½æ•°#\r// å£°æ˜ä¸€ä¸ªCçš„å¤–éƒ¨å‡½æ•° extern \u0026#34;C\u0026#34; fn add (x:i32,y:i32) i32; // å¯¼å‡ºä¸€ä¸ªå‡½æ•°ç»™c export fn add(x:i32,y:i32) callconv(.c) i32 {};å†…å­˜ç®¡ç†#\rä»¥DebugAllocatorä¸ºä¾‹.\n// è·å–DebugAllocatorå®ä¾‹ var gpa = std.heap.DebugAllocator(.{}).init; //è·å¾—åˆ†é…å™¨å®ä¾‹ const dgpa = gpa.allocator(); // å»¶æ—¶é”€æ¯ defer _ = gpa.deinit();"},{"id":2,"href":"/Programming-Notes/docs/notes/python/","title":"Python","section":"Introduction","content":"Pythoné…ç½®#\rLSP#\rBasedpyright#\rç›®å‰ä½¿ç”¨ç›¸å½“èˆ’æœçš„Python LSP ä¸º basedpyright å®ƒæä¾›ç±»å‹æ£€æŸ¥ã€inlayhintç­‰ï¼Œå¯ä»¥é€šè¿‡pyrightconfig.jsoné…ç½®ã€‚\nruff#\rä¸Basedpyrightç›¸æ¯”ï¼Œruff æä¾›äº†ä»£ç æ£€æŸ¥çš„åŠŸèƒ½ã€‚\nè™šæ‹Ÿç¯å¢ƒ#\ruv#\rRust ç¼–å†™çš„ pythonè™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·å…¶ä½¿ç”¨æ–¹æ³•ä¸Rustçš„cargoç±»ä¼¼ã€‚\n"},{"id":3,"href":"/Programming-Notes/docs/notes/zig/","title":"Zig","section":"Introduction","content":"Zig#\ré¢å‘ç³»ç»Ÿç¼–ç¨‹çš„ç¼–ç¨‹è¯­è¨€å…¶æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†ä»£æ›¿Cè¯­è¨€ã€‚\n"},{"id":4,"href":"/Programming-Notes/docs/notes/rust/","title":"Rust","section":"Introduction","content":"Rust è®°å½•#\rè®°å½•Rustä¸­å¸¸ç”¨çš„crateã€Rustæ–°å¢è¯­æ³•ä¸unsafe Rustã€‚\n"},{"id":5,"href":"/Programming-Notes/docs/notes/rust/rust_algorithm/","title":"Rust Algorithm","section":"Rust","content":"åå¤§æ’åºç®—æ³•#\rå¿«é€Ÿæ’åº#\rpub fn quick_sort(seq: \u0026amp;[i32]) -\u0026gt; Vec\u0026lt;i32\u0026gt; { if let [pivot, rest @ ..] = seq { let (left, right): (Vec\u0026lt;i32\u0026gt;, Vec\u0026lt;i32\u0026gt;) = rest.iter().partition(|x| *x \u0026lt; pivot); [quick_sort(\u0026amp;left), vec![*pivot], quick_sort(\u0026amp;right)].concat() } else { vec![] } }å½’å¹¶æ’åº#\rpub fn merge_sort(seq: \u0026amp;[i32]) -\u0026gt; Vec\u0026lt;i32\u0026gt; { match seq { [] | [_] =\u0026gt; seq.to_vec(), _ =\u0026gt; { let mid = seq.len() / 2; let (left, right) = seq.split_at(mid); merge(\u0026amp;merge_sort(left), \u0026amp;merge_sort(right)) } } } fn merge(left: \u0026amp;[i32], right: \u0026amp;[i32]) -\u0026gt; Vec\u0026lt;i32\u0026gt; { let mut left_iter = left.iter().peekable(); let mut right_iter = right.iter().peekable(); let mut result = Vec::with_capacity(left.len() + right.len()); while let (Some(l), Some(r)) = (left_iter.peek(), right_iter.peek()) { if l \u0026lt;= r { result.push(*left_iter.next().unwrap()); } else { result.push(*right_iter.next().unwrap()); } } result.extend(left_iter); result.extend(right_iter); result }é€‰æ‹©æ’åº#\rpub fn select_sort(seq: \u0026amp;mut [i32]) -\u0026gt; \u0026amp;[i32] { (0..seq.len()).for_each(|i| { let min_pos = (i..seq.len()).min_by_key(|\u0026amp;j| seq[j]).unwrap_or(i); seq.swap(i, min_pos); }); seq }å†’æ³¡æ’åº#\rpub fn bubbled_sort(seq: \u0026amp;mut [i32]) -\u0026gt; \u0026amp;[i32] { for i in 1..seq.len() { for j in (i..seq.len()).rev() { if seq[j] \u0026lt; seq[j - 1] { seq.swap(j, j - 1); } } } seq }æ»‘åŠ¨çª—å£#\rpub fn windows\u0026lt;\u0026#39;a\u0026gt;(seq: \u0026amp;\u0026#39;a [u8], pattern: \u0026amp;\u0026#39;a [u8]) -\u0026gt; Option\u0026lt;\u0026amp;\u0026#39;a [u8]\u0026gt; { use std::ops::ControlFlow; let pattern_len = pattern.len(); for wsize in pattern_len..=seq.len() { let result = seq.windows(wsize).try_for_each(|chunk| { let all_found = pattern.iter().all(|elem| chunk.contains(elem)); if all_found { ControlFlow::Break(chunk) } else { ControlFlow::Continue(()) } }); if let ControlFlow::Break(chunk) = result { return Some(chunk); } } None }"},{"id":6,"href":"/Programming-Notes/docs/notes/rust/crate/","title":"Rust Crate","section":"Rust","content":"Rust Crate#\rIMPORTANT\nè®°å½•Rustä¸­å¸¸ç”¨çš„crateä¸å…¶è¯­æ³•ã€‚\n"},{"id":7,"href":"/Programming-Notes/docs/notes/medical_imaging/","title":"Medical Imaging","section":"Introduction","content":"åŒ»å­¦å½±åƒåˆ†æç³»ç»Ÿ - å‡½æ•°æ–‡æ¡£ä¸æµç¨‹è¯´æ˜#\ré¡¹ç›®æ¦‚è¿°#\ræœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºVLMï¼ˆè§†è§‰è¯­è¨€æ¨¡å‹ï¼‰çš„åŒ»å­¦å½±åƒåˆ†æç³»ç»Ÿï¼Œæ”¯æŒåŒ»å­¦å½±åƒçš„è‡ªåŠ¨åˆ†ç±»ã€ç›®æ ‡æ£€æµ‹å’Œæ‰¹é‡åˆ†æã€‚\nç³»ç»Ÿæ¶æ„#\rCLIå±‚ (cli.py)\râ†“\råˆ†ææ ¸å¿ƒå±‚ (analyzer.py)\râ†“\rAPIé€šä¿¡å±‚ (api_client.py)\râ†“\rå·¥å…·å‡½æ•°å±‚ (utils.py)\râ†“\rç±»å‹å®šä¹‰å±‚ (types.py) æ¨¡å—è¯¦è§£#\r1. utils.py - å·¥å…·å‡½æ•°æ¨¡å—#\rå‡½æ•°ï¼šencode_image_to_base64()#\rç”¨é€”ï¼šå°†å›¾åƒæ–‡ä»¶ç¼–ç ä¸ºBase64å­—ç¬¦ä¸²ï¼Œç”¨äºé€šè¿‡APIå‘é€ç»™VLMæ¨¡å‹ã€‚\næµç¨‹ï¼š\nä»¥äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€å›¾åƒæ–‡ä»¶ è¯»å–æ–‡ä»¶å†…å®¹ ç¼–ç ä¸ºBase64æ ¼å¼ è§£ç ä¸ºUTF-8å­—ç¬¦ä¸²è¿”å› å‚æ•°ï¼š\nimage_path (str): å›¾åƒæ–‡ä»¶çš„è·¯å¾„ è¿”å›å€¼ï¼š\nBase64ç¼–ç çš„å­—ç¬¦ä¸² ç¤ºä¾‹ï¼š\nbase64_str = encode_image_to_base64(\u0026#34;path/to/image.jpg\u0026#34;) # è¿”å›: \u0026#34;iVBORw0KGgoAAAANSUhEUgAAAAUA...\u0026#34; å‡½æ•°ï¼šextract_json_from_text()#\rç”¨é€”ï¼šä»VLMæ¨¡å‹çš„å“åº”æ–‡æœ¬ä¸­æå–JSONå¯¹è±¡ã€‚æ¨¡å‹å¯èƒ½åœ¨JSONå‰åæ·»åŠ å…¶ä»–æ–‡æœ¬ï¼Œæ­¤å‡½æ•°è´Ÿè´£å®šä½å¹¶æå–JSONéƒ¨åˆ†ã€‚\næµç¨‹ï¼š\næŸ¥æ‰¾ç¬¬ä¸€ä¸ªå·¦èŠ±æ‹¬å· { çš„ä½ç½® æŸ¥æ‰¾æœ€åä¸€ä¸ªå³èŠ±æ‹¬å· } çš„ä½ç½® æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°æœ‰æ•ˆçš„JSONèŒƒå›´ å°è¯•è§£æJSONå­—ç¬¦ä¸²ä¸ºå­—å…¸ å¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›åŒ…å«åŸå§‹å“åº”çš„å­—å…¸ å‚æ•°ï¼š\ntext (str): åŒ…å«JSONçš„æ–‡æœ¬ è¿”å›å€¼ï¼š\ndict[str, Any]: æå–çš„JSONå­—å…¸ï¼Œæˆ–åŒ…å« raw_response çš„å­—å…¸ ç¤ºä¾‹ï¼š\ntext = \u0026#34;æ¨¡å‹åˆ†æç»“æœå¦‚ä¸‹ï¼š{\\\u0026#34;category\\\u0026#34;: \\\u0026#34;æ­£å¸¸\\\u0026#34;, \\\u0026#34;confidence\\\u0026#34;: 95}\u0026#34; result = extract_json_from_text(text) # è¿”å›: {\u0026#34;category\u0026#34;: \u0026#34;æ­£å¸¸\u0026#34;, \u0026#34;confidence\u0026#34;: 95} å‡½æ•°ï¼šget_image_files_from_folder()#\rç”¨é€”ï¼šæ‰«ææŒ‡å®šæ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶å¤¹ï¼Œæ‰¾å‡ºæ‰€æœ‰æ”¯æŒçš„åŒ»å­¦å½±åƒæ ¼å¼æ–‡ä»¶ã€‚\næµç¨‹ï¼š\nå°†è·¯å¾„å­—ç¬¦ä¸²è½¬æ¢ä¸ºPathå¯¹è±¡ æ£€æŸ¥æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ æ£€æŸ¥è·¯å¾„æ˜¯å¦ä¸ºç›®å½• å®šä¹‰æ”¯æŒçš„å›¾åƒæ‰©å±•åé›†åˆ é€’å½’éå†æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶ ç­›é€‰å‡ºå›¾åƒæ–‡ä»¶ è¿”å›æ’åºåçš„æ–‡ä»¶è·¯å¾„åˆ—è¡¨ æ”¯æŒçš„å›¾åƒæ ¼å¼ï¼š\n.jpg, .jpeg, .png, .bmp, .gif, .webp, .tiff, .tif å‚æ•°ï¼š\nfolder_path (str): æ–‡ä»¶å¤¹è·¯å¾„ è¿”å›å€¼ï¼š\nlist[str]: æ’åºåçš„å›¾åƒæ–‡ä»¶è·¯å¾„åˆ—è¡¨ å¼‚å¸¸ï¼š\nFileNotFoundError: å¦‚æœæ–‡ä»¶å¤¹ä¸å­˜åœ¨ ValueError: å¦‚æœè·¯å¾„ä¸æ˜¯ç›®å½• ç¤ºä¾‹ï¼š\nimages = get_image_files_from_folder(\u0026#34;path/to/medical_images\u0026#34;) # è¿”å›: [\u0026#34;path/to/medical_images/image1.jpg\u0026#34;, \u0026#34;path/to/medical_images/image2.png\u0026#34;] 2. types.py - ç±»å‹å®šä¹‰æ¨¡å—#\ræœ¬æ¨¡å—å®šä¹‰äº†æ•´ä¸ªç³»ç»Ÿä½¿ç”¨çš„æ•°æ®ç»“æ„ï¼Œç¡®ä¿ç±»å‹å®‰å…¨å’Œä»£ç å¯è¯»æ€§ã€‚\nClassificationResult#\rç”¨é€”ï¼šå­˜å‚¨å•å¼ åŒ»å­¦å½±åƒçš„åˆ†ç±»åˆ†æç»“æœã€‚\nå­—æ®µï¼š\nsuccess (bool): åˆ†ç±»æ˜¯å¦æˆåŠŸ image_path (str): å›¾åƒæ–‡ä»¶è·¯å¾„ result (dict[str, Any]): åˆ†ç±»ç»“æœçš„è¯¦ç»†æ•°æ®ï¼ˆåŒ…å«categoryã€confidenceç­‰ï¼‰ full_response (str): VLMæ¨¡å‹çš„å®Œæ•´å“åº”æ–‡æœ¬ error (str): é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœåˆ†ç±»å¤±è´¥ï¼‰ ç¤ºä¾‹ï¼š\nresult: ClassificationResult = { \u0026#34;success\u0026#34;: True, \u0026#34;image_path\u0026#34;: \u0026#34;image.jpg\u0026#34;, \u0026#34;result\u0026#34;: { \u0026#34;image_type\u0026#34;: \u0026#34;Xå…‰ç‰‡\u0026#34;, \u0026#34;category\u0026#34;: \u0026#34;è‚ºç‚\u0026#34;, \u0026#34;confidence\u0026#34;: 92, \u0026#34;features\u0026#34;: \u0026#34;å³è‚ºä¸‹å¶æœ‰æµ¸æ¶¦å½±\u0026#34;, \u0026#34;reasoning\u0026#34;: \u0026#34;...\u0026#34; }, \u0026#34;full_response\u0026#34;: \u0026#34;...\u0026#34; } DetectionObject#\rç”¨é€”ï¼šè¡¨ç¤ºåŒ»å­¦å½±åƒä¸­æ£€æµ‹åˆ°çš„å¼‚å¸¸åŒºåŸŸæˆ–é‡è¦ç»“æ„ã€‚\nå­—æ®µï¼š\ntype (str): å¯¹è±¡ç±»å‹ï¼ˆå¦‚\u0026quot;è‚ºç‚\u0026quot;ã€\u0026ldquo;è‚¿ç˜¤\u0026quot;ç­‰ï¼‰ bbox (list[float]): è¾¹ç•Œæ¡†åæ ‡ [x_min, y_min, x_max, y_max]ï¼Œå½’ä¸€åŒ–åˆ°0-1 confidence (float): æ£€æµ‹ç½®ä¿¡åº¦ï¼ˆ0-100ï¼‰ size (str): å¯¹è±¡å¤§å°æè¿° description (str): å¯¹è±¡çš„è¯¦ç»†æè¿° DetectionResult#\rç”¨é€”ï¼šå­˜å‚¨å•å¼ åŒ»å­¦å½±åƒçš„ç›®æ ‡æ£€æµ‹åˆ†æç»“æœã€‚\nå­—æ®µï¼š\nsuccess (bool): æ£€æµ‹æ˜¯å¦æˆåŠŸ image_path (str): å›¾åƒæ–‡ä»¶è·¯å¾„ result (dict[str, Any]): æ£€æµ‹ç»“æœçš„è¯¦ç»†æ•°æ® full_response (str): VLMæ¨¡å‹çš„å®Œæ•´å“åº”æ–‡æœ¬ error (str): é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœæ£€æµ‹å¤±è´¥ï¼‰ AnalysisResult#\rç”¨é€”ï¼šå­˜å‚¨æ‰¹é‡åŒ»å­¦å½±åƒåˆ†æçš„ç»¼åˆç»“æœï¼ŒåŒ…æ‹¬åˆ†ç»„ã€ç»Ÿè®¡å’Œè§£é‡Šã€‚\nå­—æ®µï¼š\ntotal_images (int): åˆ†æçš„å›¾åƒæ€»æ•° classification_results (list[ClassificationResult]): æ‰€æœ‰å›¾åƒçš„åˆ†ç±»ç»“æœåˆ—è¡¨ grouped_by_category (dict[str, list[ClassificationResult]]): æŒ‰è¯Šæ–­ç±»åˆ«åˆ†ç»„çš„ç»“æœ explanations (dict[str, Any]): æ¯ä¸ªç±»åˆ«çš„è§£é‡Šè¯´æ˜ statistics (dict[str, Any]): ç»Ÿè®¡ä¿¡æ¯ï¼ˆç±»åˆ«æ•°ã€åˆ†å¸ƒç­‰ï¼‰ 3. api_client.py - VLM APIå®¢æˆ·ç«¯æ¨¡å—#\rç±»ï¼šVLMClient#\rç”¨é€”ï¼šå°è£…ä¸VLMæœåŠ¡çš„HTTPé€šä¿¡ï¼Œå¤„ç†è®¤è¯ã€è¯·æ±‚æ„å»ºå’Œå“åº”è§£æã€‚æ”¯æŒä¸Šä¸‹æ–‡ç®¡ç†å™¨åè®®ï¼Œç¡®ä¿èµ„æºæ­£ç¡®é‡Šæ”¾ã€‚\næ–¹æ³•ï¼šinit()#\ræµç¨‹ï¼š\nä¿å­˜APIé…ç½®å‚æ•° åˆ›å»ºHTTPä¼šè¯å¯¹è±¡ è®¾ç½®è®¤è¯å¤´å’Œå†…å®¹ç±»å‹ å‚æ•°ï¼š\napi_key (str): APIå¯†é’¥ï¼Œç”¨äºèº«ä»½éªŒè¯ base_url (str): APIæœåŠ¡çš„åŸºç¡€URL model_name (str): è¦ä½¿ç”¨çš„æ¨¡å‹åç§° ç¤ºä¾‹ï¼š\nclient = VLMClient( api_key=\u0026#34;sk-xxx\u0026#34;, base_url=\u0026#34;https://api.example.com/v1\u0026#34;, model_name=\u0026#34;qwen3-vl-plus\u0026#34; ) æ–¹æ³•ï¼šcall()#\rç”¨é€”ï¼šè°ƒç”¨VLM APIè¿›è¡Œæ¨ç†ã€‚\næµç¨‹ï¼š\næ„å»ºAPIç«¯ç‚¹URL ç»„è£…è¯·æ±‚è´Ÿè½½ï¼ˆæ¨¡å‹åã€æ¶ˆæ¯ã€å‚æ•°ï¼‰ å‘é€POSTè¯·æ±‚åˆ°VLMæœåŠ¡ è§£æå“åº”JSON æå–æ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬å†…å®¹ å‚æ•°ï¼š\nmessages (list[dict[str, Any]]): æ¶ˆæ¯åˆ—è¡¨ï¼Œæ¯æ¡æ¶ˆæ¯åŒ…å«roleå’Œcontent max_tokens (int, é»˜è®¤2000): æ¨¡å‹ç”Ÿæˆçš„æœ€å¤§ä»¤ç‰Œæ•° temperature (float, é»˜è®¤0.3): ç”Ÿæˆæ¸©åº¦ï¼ˆ0.3è¡¨ç¤ºä½éšæœºæ€§ï¼Œæ›´ç¡®å®šæ€§ï¼‰ è¿”å›å€¼ï¼š\nstr: æ¨¡å‹ç”Ÿæˆçš„å“åº”æ–‡æœ¬ å¼‚å¸¸ï¼š\nRuntimeError: å¦‚æœå“åº”æ ¼å¼æ— æ•ˆæˆ–ç¼ºå°‘é¢„æœŸå­—æ®µ ç¤ºä¾‹ï¼š\nresponse = client.call( messages=[ { \u0026#34;role\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;content\u0026#34;: [ {\u0026#34;type\u0026#34;: \u0026#34;text\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;åˆ†æè¿™å¼ åŒ»å­¦å½±åƒ\u0026#34;}, {\u0026#34;type\u0026#34;: \u0026#34;image_url\u0026#34;, \u0026#34;image_url\u0026#34;: {\u0026#34;url\u0026#34;: \u0026#34;data:image/jpeg;base64,...\u0026#34;}} ] } ], max_tokens=2000, temperature=0.3 ) æ–¹æ³•ï¼šclose()#\rç”¨é€”ï¼šå…³é—­HTTPä¼šè¯ï¼Œé‡Šæ”¾èµ„æºã€‚\nä¸Šä¸‹æ–‡ç®¡ç†å™¨æ”¯æŒ#\rç”¨é€”ï¼šæ”¯æŒwithè¯­å¥ä½¿ç”¨ï¼Œç¡®ä¿èµ„æºæ­£ç¡®é‡Šæ”¾ã€‚\nç¤ºä¾‹ï¼š\nwith VLMClient(api_key, base_url, model_name) as client: response = client.call(messages) # è‡ªåŠ¨è°ƒç”¨close()é‡Šæ”¾èµ„æº 4. analyzer.py - åŒ»å­¦å½±åƒåˆ†æå™¨æ¨¡å—#\rç±»ï¼šMedicalImageAnalyzer#\rç”¨é€”ï¼šæä¾›åŒ»å­¦å½±åƒåˆ†æçš„ä¸»è¦åŠŸèƒ½ï¼ŒåŒ…æ‹¬å•å¼ å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€æ‰¹é‡å›¾åƒåˆ†æã€ç»“æœåˆ†ç»„å’Œè§£é‡Šã€‚\næ–¹æ³•ï¼šinit()#\ræµç¨‹ï¼š\nåˆ›å»ºVLMå®¢æˆ·ç«¯å®ä¾‹ ä¿å­˜APIé…ç½® å‚æ•°ï¼š\napi_key (str): VLMæœåŠ¡çš„APIå¯†é’¥ base_url (str): VLMæœåŠ¡çš„åŸºç¡€URL model_name (str): è¦ä½¿ç”¨çš„æ¨¡å‹åç§° æ–¹æ³•ï¼šclassify_image()#\rç”¨é€”ï¼šå¯¹åŒ»å­¦å½±åƒè¿›è¡Œåˆ†ç±»ã€‚\næµç¨‹ï¼š\néªŒè¯å›¾åƒæ–‡ä»¶æ˜¯å¦å­˜åœ¨ å°†å›¾åƒç¼–ç ä¸ºBase64æ ¼å¼ æ ¹æ®æ˜¯å¦æä¾›ç±»åˆ«åˆ—è¡¨æ„å»ºä¸åŒçš„æç¤ºè¯ è°ƒç”¨VLM APIè¿›è¡Œåˆ†ç±» ä»å“åº”ä¸­æå–JSONç»“æœ è¿”å›åˆ†ç±»ç»“æœæˆ–é”™è¯¯ä¿¡æ¯ å‚æ•°ï¼š\nimage_path (str): å›¾åƒæ–‡ä»¶è·¯å¾„ categories (list[str] | None): å¯é€‰çš„åˆ†ç±»ç±»åˆ«åˆ—è¡¨ è¿”å›å€¼ï¼š\nClassificationResult: åˆ†ç±»ç»“æœå­—å…¸ å¼‚å¸¸ï¼š\nFileNotFoundError: å¦‚æœå›¾åƒæ–‡ä»¶ä¸å­˜åœ¨ è¿”å›ç»“æœç¤ºä¾‹ï¼š\n{ \u0026#34;success\u0026#34;: True, \u0026#34;image_path\u0026#34;: \u0026#34;image.jpg\u0026#34;, \u0026#34;result\u0026#34;: { \u0026#34;image_type\u0026#34;: \u0026#34;Xå…‰ç‰‡\u0026#34;, \u0026#34;category\u0026#34;: \u0026#34;è‚ºç‚\u0026#34;, \u0026#34;confidence\u0026#34;: 92, \u0026#34;features\u0026#34;: \u0026#34;å³è‚ºä¸‹å¶æœ‰æµ¸æ¶¦å½±\u0026#34;, \u0026#34;reasoning\u0026#34;: \u0026#34;åŸºäºå½±åƒç‰¹å¾åˆ†æ...\u0026#34; }, \u0026#34;full_response\u0026#34;: \u0026#34;...\u0026#34; } æ–¹æ³•ï¼šdetect_objects()#\rç”¨é€”ï¼šåœ¨åŒ»å­¦å½±åƒä¸­æ£€æµ‹ç›®æ ‡å¯¹è±¡ã€‚\næµç¨‹ï¼š\néªŒè¯å›¾åƒæ–‡ä»¶æ˜¯å¦å­˜åœ¨ å°†å›¾åƒç¼–ç ä¸ºBase64æ ¼å¼ å¦‚æœæä¾›äº†åˆ†ç±»ç»“æœï¼Œæå–åˆ†ç±»ä¿¡æ¯ä½œä¸ºä¸Šä¸‹æ–‡ æ ¹æ®æ˜¯å¦æä¾›ç›®æ ‡å¯¹è±¡åˆ—è¡¨æ„å»ºä¸åŒçš„æç¤ºè¯ è°ƒç”¨VLM APIè¿›è¡Œç›®æ ‡æ£€æµ‹ ä»å“åº”ä¸­æå–JSONç»“æœ è¿”å›æ£€æµ‹ç»“æœæˆ–é”™è¯¯ä¿¡æ¯ ç‰¹ç‚¹ï¼š\næ”¯æŒåŸºäºåˆ†ç±»ç»“æœçš„ä¸Šä¸‹æ–‡æ£€æµ‹ å¦‚æœåˆ†ç±»ç»“æœæ˜¾ç¤ºå¼‚å¸¸ï¼Œä¼šç‰¹åˆ«å¼ºè°ƒæ£€æµ‹å¼‚å¸¸åŒºåŸŸ è¿”å›è¾¹ç•Œæ¡†åæ ‡å’Œç½®ä¿¡åº¦ å‚æ•°ï¼š\nimage_path (str): å›¾åƒæ–‡ä»¶è·¯å¾„ target_objects (list[str] | None): å¯é€‰çš„ç›®æ ‡å¯¹è±¡åˆ—è¡¨ classification_result (ClassificationResult | None): å¯é€‰çš„åˆ†ç±»ç»“æœ è¿”å›å€¼ï¼š\nDetectionResult: æ£€æµ‹ç»“æœå­—å…¸ æ–¹æ³•ï¼šanalyze_images()#\rç”¨é€”ï¼šåˆ†æåŒ»å­¦å½±åƒï¼ˆå•å¼ æˆ–å¤šå¼ ï¼‰ã€‚\næµç¨‹ï¼š\nè§„èŒƒåŒ–è¾“å…¥ï¼šå°†å•ä¸ªè·¯å¾„è½¬æ¢ä¸ºåˆ—è¡¨ï¼Œå¤„ç†æ–‡ä»¶å¤¹è·¯å¾„ éªŒè¯æ‰€æœ‰å›¾åƒæ–‡ä»¶æ˜¯å¦å­˜åœ¨ æ ¹æ®å›¾åƒæ•°é‡é€‰æ‹©åˆ†ææ–¹å¼ï¼š å•å¼ å›¾åƒï¼šç›´æ¥è¿”å›åˆ†ç±»ç»“æœ å¤šå¼ å›¾åƒï¼šè¿›è¡Œåˆ†ç»„ã€ç»Ÿè®¡å’Œè§£é‡Š ç‰¹ç‚¹ï¼š\næ”¯æŒçµæ´»çš„è¾“å…¥æ ¼å¼ï¼ˆå•ä¸ªæ–‡ä»¶ã€æ–‡ä»¶åˆ—è¡¨ã€æ–‡ä»¶å¤¹ï¼‰ è‡ªåŠ¨å¤„ç†æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰å›¾åƒ è¿”å›ç»“æœæ ¼å¼æ ¹æ®å›¾åƒæ•°é‡è‡ªåŠ¨è°ƒæ•´ å‚æ•°ï¼š\nimage_paths (str | list[str]): å•ä¸ªå›¾åƒè·¯å¾„ã€è·¯å¾„åˆ—è¡¨æˆ–æ–‡ä»¶å¤¹è·¯å¾„ categories (list[str] | None): å¯é€‰çš„åˆ†ç±»ç±»åˆ«åˆ—è¡¨ è¿”å›å€¼ï¼š\ndict[str, Any]: åˆ†æç»“æœå­—å…¸ å¼‚å¸¸ï¼š\nFileNotFoundError: å¦‚æœä»»ä½•å›¾åƒæ–‡ä»¶ä¸å­˜åœ¨ æ–¹æ³•ï¼š_analyze_single_image()#\rç”¨é€”ï¼šåˆ†æå•å¼ å›¾åƒã€‚\næµç¨‹ï¼š\nè°ƒç”¨classify_imageæ–¹æ³•è¿›è¡Œåˆ†ç±» è¿”å›åˆ†ç±»ç»“æœ å‚æ•°ï¼š\nimage_path (str): å›¾åƒæ–‡ä»¶è·¯å¾„ categories (list[str] | None): å¯é€‰çš„åˆ†ç±»ç±»åˆ«åˆ—è¡¨ è¿”å›å€¼ï¼š\nClassificationResult: åˆ†ç±»ç»“æœå­—å…¸ æ–¹æ³•ï¼š_analyze_multiple_images()#\rç”¨é€”ï¼šåˆ†æå¤šå¼ å›¾åƒã€‚\næµç¨‹ï¼š\nå¯¹æ¯å¼ å›¾åƒè¿›è¡Œåˆ†ç±» æŒ‰è¯Šæ–­ç±»åˆ«å¯¹ç»“æœè¿›è¡Œåˆ†ç»„ ä¸ºæ¯ä¸ªç±»åˆ«ç”Ÿæˆè§£é‡Šè¯´æ˜ è®¡ç®—ç»Ÿè®¡ä¿¡æ¯ è¿”å›ç»¼åˆåˆ†æç»“æœ ç‰¹ç‚¹ï¼š\nè‡ªåŠ¨åˆ†ç»„ç›¸åŒè¯Šæ–­ç±»åˆ«çš„å›¾åƒ ç”Ÿæˆæ¯ä¸ªç±»åˆ«çš„å…±åŒç‰¹å¾è§£é‡Š æä¾›ç±»åˆ«åˆ†å¸ƒç»Ÿè®¡ å‚æ•°ï¼š\nimage_paths (list[str]): å›¾åƒæ–‡ä»¶è·¯å¾„åˆ—è¡¨ categories (list[str] | None): å¯é€‰çš„åˆ†ç±»ç±»åˆ«åˆ—è¡¨ è¿”å›å€¼ï¼š\ndict[str, Any]: åŒ…å«åˆ†ç»„ã€ç»Ÿè®¡å’Œè§£é‡Šçš„ç»¼åˆåˆ†æç»“æœ æ–¹æ³•ï¼š_explain_classification_groups()#\rç”¨é€”ï¼šè§£é‡Šä¸ºä»€ä¹ˆå›¾åƒè¢«åˆ†ç»„åœ¨ä¸€èµ·ã€‚\næµç¨‹ï¼š\néå†æ¯ä¸ªåˆ†ç±»ç±»åˆ« æå–è¯¥ç±»åˆ«ä¸­æ‰€æœ‰å›¾åƒçš„ç‰¹å¾å’Œæ¨ç†ä¿¡æ¯ æ„å»ºåŒ…å«æ‰€æœ‰å›¾åƒä¿¡æ¯çš„æç¤ºè¯ è°ƒç”¨VLM APIç”Ÿæˆç±»åˆ«è§£é‡Š æå–å¹¶ä¿å­˜è§£é‡Šç»“æœ ç‰¹ç‚¹ï¼š\nä¸ºæ¯ä¸ªç±»åˆ«ç”Ÿæˆç»Ÿä¸€çš„è§£é‡Š åˆ†æç±»åˆ«å†…å›¾åƒçš„å…±åŒç‰¹å¾ è¯†åˆ«å›¾åƒä¹‹é—´çš„ç»†å¾®å·®å¼‚ å¤„ç†APIè°ƒç”¨å¤±è´¥çš„æƒ…å†µ å‚æ•°ï¼š\ngrouped_images (dict[str, list[ClassificationResult]]): æŒ‰ç±»åˆ«åˆ†ç»„çš„å›¾åƒç»“æœå­—å…¸ è¿”å›å€¼ï¼š\ndict[str, Any]: æ¯ä¸ªç±»åˆ«çš„è§£é‡Šè¯´æ˜å­—å…¸ æ–¹æ³•ï¼šclose()#\rç”¨é€”ï¼šå…³é—­åˆ†æå™¨å¹¶é‡Šæ”¾èµ„æºã€‚\næµç¨‹ï¼š\nå…³é—­VLMå®¢æˆ·ç«¯çš„HTTPä¼šè¯ é‡Šæ”¾ç½‘ç»œè¿æ¥ ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ”¯æŒ#\rç”¨é€”ï¼šæ”¯æŒwithè¯­å¥ä½¿ç”¨ï¼Œç¡®ä¿èµ„æºæ­£ç¡®é‡Šæ”¾ã€‚\nç¤ºä¾‹ï¼š\nwith MedicalImageAnalyzer(api_key, base_url, model_name) as analyzer: results = analyzer.analyze_images(\u0026#34;path/to/images\u0026#34;) # è‡ªåŠ¨è°ƒç”¨close()é‡Šæ”¾èµ„æº 5. cli.py - å‘½ä»¤è¡Œç•Œé¢æ¨¡å—#\rå‡½æ•°ï¼šprint_classification_results()#\rç”¨é€”ï¼šæ‰“å°å•å¼ å›¾åƒçš„åˆ†ç±»ç»“æœã€‚\næµç¨‹ï¼š\næ£€æŸ¥åˆ†ç±»æ˜¯å¦æˆåŠŸ å¦‚æœå¤±è´¥ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ å¦‚æœæˆåŠŸï¼ŒæŒ‰æ ¼å¼åŒ–æ–¹å¼æ‰“å°ï¼š å›¾åƒåŸºæœ¬ä¿¡æ¯ï¼ˆè·¯å¾„ã€ç±»å‹ï¼‰ ç‰¹å¾åˆ†æï¼ˆå…³é”®ç‰¹å¾ã€æ¨ç†è¿‡ç¨‹ï¼‰ åˆ†ç±»ç»“æœï¼ˆè¯Šæ–­ç±»åˆ«ã€ç½®ä¿¡åº¦ã€å¼‚å¸¸æ ‡è®°ï¼‰ å‚æ•°ï¼š\nresults (dict[str, Any]): åˆ†ç±»ç»“æœå­—å…¸ è¾“å‡ºç¤ºä¾‹ï¼š\n============================================================\rClassification Results\r============================================================\rImage path: image.jpg\rImage type: Xå…‰ç‰‡\rã€Image Feature Analysisã€‘\r------------------------------------------------------------\rKey features:\rå³è‚ºä¸‹å¶æœ‰æµ¸æ¶¦å½±\rAnalysis reasoning:\råŸºäºå½±åƒç‰¹å¾åˆ†æ...\rã€Classification Resultã€‘\r------------------------------------------------------------\rDiagnosis category: è‚ºç‚\rConfidence: 92%\rAbnormal: Yes\r============================================================ å‡½æ•°ï¼šprint_multiple_analysis_results()#\rç”¨é€”ï¼šæ‰“å°å¤šå¼ å›¾åƒçš„åˆ†æç»“æœã€‚\næµç¨‹ï¼š\næ‰“å°æ€»ä½“ç»Ÿè®¡ä¿¡æ¯ï¼ˆå›¾åƒæ€»æ•°ã€ç±»åˆ«æ•°ã€åˆ†å¸ƒï¼‰ éå†æ¯ä¸ªåˆ†ç±»ç±»åˆ« å¯¹äºæ¯ä¸ªç±»åˆ«ï¼Œæ‰“å°ï¼š ç±»åˆ«åç§°å’Œå›¾åƒæ•°é‡ å…±åŒç‰¹å¾ åˆ†ç±»åŸå›  ç›¸ä¼¼æ€§åˆ†æ å·®å¼‚åˆ†æ æ€»ç»“è¯´æ˜ å‚æ•°ï¼š\nresults (dict[str, Any]): å¤šå¼ å›¾åƒåˆ†æç»“æœå­—å…¸ å‡½æ•°ï¼šmain()#\rç”¨é€”ï¼šä¸»CLIå…¥å£ç‚¹ã€‚\næµç¨‹ï¼š\næ‰“å°æ¬¢è¿ä¿¡æ¯ åˆå§‹åŒ–åŒ»å­¦å½±åƒåˆ†æå™¨ å®šä¹‰åˆ†ç±»ç±»åˆ«åˆ—è¡¨ è·å–ç”¨æˆ·è¾“å…¥çš„å›¾åƒè·¯å¾„ï¼ˆå‘½ä»¤è¡Œå‚æ•°æˆ–äº¤äº’å¼è¾“å…¥ï¼‰ éªŒè¯è·¯å¾„æ˜¯å¦å­˜åœ¨ è°ƒç”¨åˆ†æå™¨è¿›è¡Œåˆ†æ æ ¹æ®ç»“æœç±»å‹é€‰æ‹©åˆé€‚çš„æ‰“å°å‡½æ•° å¤„ç†å¼‚å¸¸å¹¶ç¡®ä¿èµ„æºé‡Šæ”¾ æ”¯æŒçš„åˆ†ç±»ç±»åˆ«ï¼š\nNormalï¼ˆæ­£å¸¸ï¼‰ Pneumoniaï¼ˆè‚ºç‚ï¼‰ Tuberculosisï¼ˆç»“æ ¸ç—…ï¼‰ Lung Cancerï¼ˆè‚ºç™Œï¼‰ Other Abnormalitiesï¼ˆå…¶ä»–å¼‚å¸¸ï¼‰ ä½¿ç”¨ç¤ºä¾‹ï¼š\n# å‘½ä»¤è¡Œå‚æ•°æ–¹å¼ python -m medical_imaging.cli path/to/image.jpg # äº¤äº’å¼è¾“å…¥æ–¹å¼ python -m medical_imaging.cli # ç„¶åè¾“å…¥å›¾åƒè·¯å¾„æˆ–æ–‡ä»¶å¤¹è·¯å¾„ å®Œæ•´å·¥ä½œæµç¨‹#\rå•å¼ å›¾åƒåˆ†ææµç¨‹#\rç”¨æˆ·è¾“å…¥å›¾åƒè·¯å¾„\râ†“\rmain() éªŒè¯è·¯å¾„\râ†“\ranalyzer.analyze_images()\râ†“\r_analyze_single_image()\râ†“\rclassify_image()\râ”œâ”€ éªŒè¯æ–‡ä»¶å­˜åœ¨\râ”œâ”€ encode_image_to_base64() ç¼–ç å›¾åƒ\râ”œâ”€ æ„å»ºæç¤ºè¯\râ”œâ”€ client.call() è°ƒç”¨VLM API\râ”œâ”€ extract_json_from_text() æå–ç»“æœ\râ””â”€ è¿”å›ClassificationResult\râ†“\rprint_classification_results() æ‰“å°ç»“æœ\râ†“\ranalyzer.close() é‡Šæ”¾èµ„æºå¤šå¼ å›¾åƒåˆ†ææµç¨‹#\rç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹è·¯å¾„\râ†“\rmain() éªŒè¯è·¯å¾„\râ†“\ranalyzer.analyze_images()\râ†“\rget_image_files_from_folder() è·å–æ‰€æœ‰å›¾åƒ\râ†“\r_analyze_multiple_images()\râ”œâ”€ å¯¹æ¯å¼ å›¾åƒè°ƒç”¨ classify_image()\râ”œâ”€ æŒ‰categoryåˆ†ç»„ç»“æœ\râ”œâ”€ _explain_classification_groups()\râ”‚ â”œâ”€ ä¸ºæ¯ä¸ªç±»åˆ«æå–å›¾åƒä¿¡æ¯\râ”‚ â”œâ”€ æ„å»ºè§£é‡Šæç¤ºè¯\râ”‚ â”œâ”€ client.call() ç”Ÿæˆè§£é‡Š\râ”‚ â””â”€ ä¿å­˜è§£é‡Šç»“æœ\râ”œâ”€ è®¡ç®—ç»Ÿè®¡ä¿¡æ¯\râ””â”€ è¿”å›AnalysisResult\râ†“\rprint_multiple_analysis_results() æ‰“å°ç»“æœ\râ†“\ranalyzer.close() é‡Šæ”¾èµ„æº APIè¯·æ±‚æ ¼å¼#\rVLM API è¯·æ±‚ç¤ºä¾‹#\r{ \u0026#34;model\u0026#34;: \u0026#34;qwen3-vl-plus\u0026#34;, \u0026#34;messages\u0026#34;: [ { \u0026#34;role\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;content\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;text\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;è¯·å¯¹è¿™å¼ åŒ»ç–—å½±åƒè¿›è¡Œä¸“ä¸šåˆ†ç±»...\u0026#34; }, { \u0026#34;type\u0026#34;: \u0026#34;image_url\u0026#34;, \u0026#34;image_url\u0026#34;: { \u0026#34;url\u0026#34;: \u0026#34;data:image/jpeg;base64,iVBORw0KGgo...\u0026#34; } } ] } ], \u0026#34;max_tokens\u0026#34;: 2000, \u0026#34;temperature\u0026#34;: 0.3 }VLM API å“åº”ç¤ºä¾‹#\r{ \u0026#34;choices\u0026#34;: [ { \u0026#34;message\u0026#34;: { \u0026#34;content\u0026#34;: \u0026#34;{\\\u0026#34;image_type\\\u0026#34;: \\\u0026#34;Xå…‰ç‰‡\\\u0026#34;, \\\u0026#34;category\\\u0026#34;: \\\u0026#34;è‚ºç‚\\\u0026#34;, \\\u0026#34;confidence\\\u0026#34;: 92, \\\u0026#34;features\\\u0026#34;: \\\u0026#34;å³è‚ºä¸‹å¶æœ‰æµ¸æ¶¦å½±\\\u0026#34;, \\\u0026#34;reasoning\\\u0026#34;: \\\u0026#34;...\\\u0026#34;}\u0026#34; } } ] } é”™è¯¯å¤„ç†#\rç³»ç»Ÿåœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä¼šè¿”å›é”™è¯¯ï¼š\næ–‡ä»¶ä¸å­˜åœ¨ï¼šFileNotFoundError è·¯å¾„ä¸æ˜¯ç›®å½•ï¼šValueError APIå“åº”æ ¼å¼æ— æ•ˆï¼šRuntimeError ç½‘ç»œè¿æ¥å¤±è´¥ï¼šrequests.RequestException JSONè§£æå¤±è´¥ï¼šè¿”å› {\u0026quot;raw_response\u0026quot;: text} æ‰€æœ‰å¼‚å¸¸éƒ½ä¼šè¢«æ•è·å¹¶è¿”å›åŒ…å« success: False å’Œ error å­—æ®µçš„ç»“æœã€‚\né…ç½®å‚æ•°#\rVLM API é…ç½®#\rDEFAULT_VLM_API_KEY = \u0026#34;sk-854d708e4615444689646f3f7f979b8b\u0026#34; DEFAULT_VLM_BASE_URL = \u0026#34;https://dashscope.aliyuncs.com/compatible-mode/v1\u0026#34; DEFAULT_VLM_MODEL_NAME = \u0026#34;qwen3-vl-plus\u0026#34;åˆ†ç±»å‚æ•°#\rmax_tokens: 2000ï¼ˆåˆ†ç±»ä»»åŠ¡ï¼‰ max_tokens: 3000ï¼ˆæ£€æµ‹ä»»åŠ¡ï¼‰ temperature: 0.3ï¼ˆä½éšæœºæ€§ï¼Œç¡®å®šæ€§å¼ºï¼‰ æ€»ç»“#\rè¿™ä¸ªåŒ»å­¦å½±åƒåˆ†æç³»ç»Ÿé€šè¿‡æ¨¡å—åŒ–è®¾è®¡ï¼Œæ¸…æ™°åœ°åˆ†ç¦»äº†å„ä¸ªåŠŸèƒ½å±‚ï¼š\nå·¥å…·å±‚ï¼šå¤„ç†åŸºç¡€æ“ä½œï¼ˆç¼–ç ã€æå–ã€æ‰«æï¼‰ ç±»å‹å±‚ï¼šå®šä¹‰æ•°æ®ç»“æ„ é€šä¿¡å±‚ï¼šå¤„ç†APIäº¤äº’ åˆ†æå±‚ï¼šå®ç°æ ¸å¿ƒåˆ†æé€»è¾‘ ç•Œé¢å±‚ï¼šæä¾›ç”¨æˆ·äº¤äº’ æ•´ä¸ªç³»ç»Ÿæ”¯æŒçµæ´»çš„è¾“å…¥æ–¹å¼ã€å®Œå–„çš„é”™è¯¯å¤„ç†å’Œèµ„æºç®¡ç†ï¼Œå¯ä»¥é«˜æ•ˆåœ°å¤„ç†å•å¼ æˆ–æ‰¹é‡åŒ»å­¦å½±åƒåˆ†æä»»åŠ¡ã€‚\n"},{"id":8,"href":"/Programming-Notes/docs/notes/python/functional_py/","title":"Functional Py","section":"Python","content":"Pytoolz#\rA functional standard library for Python.\næ ¸å¿ƒæ¨¡å—#\rItertoolz - è¿­ä»£å·¥å…·#\rå¤„ç†åºåˆ—å’Œè¿­ä»£å™¨çš„å‡½æ•°ï¼š\nå‡½æ•° è¯´æ˜ accumulate(binop, seq[, initial]) å¯¹åºåˆ—é‡å¤åº”ç”¨äºŒå…ƒå‡½æ•°ï¼Œç´¯ç§¯ç»“æœ concat(seqs) è¿æ¥é›¶ä¸ªæˆ–å¤šä¸ªå¯è¿­ä»£å¯¹è±¡ concatv(*seqs) concatçš„å¯å˜å‚æ•°ç‰ˆæœ¬ cons(el, seq) å°†å…ƒç´ æ·»åŠ åˆ°åºåˆ—å¼€å¤´ count(seq) è®¡ç®—åºåˆ—ä¸­çš„é¡¹æ•° drop(n, seq) è¿”å›è·³è¿‡å‰nä¸ªå…ƒç´ åçš„åºåˆ— first(seq) åºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´  frequencies(seq) æ‰¾å‡ºåºåˆ—ä¸­æ¯ä¸ªå€¼å‡ºç°çš„æ¬¡æ•° get(ind, seq[, default]) è·å–åºåˆ—æˆ–å­—å…¸ä¸­çš„å…ƒç´  groupby(key, seq) æŒ‰é”®å‡½æ•°å¯¹é›†åˆè¿›è¡Œåˆ†ç»„ interleave(seqs) äº¤é”™ä¸€ä¸ªåºåˆ—çš„åºåˆ— interpose(el, seq) åœ¨åºåˆ—çš„æ¯å¯¹å…ƒç´ ä¹‹é—´å¼•å…¥å…ƒç´  isdistinct(seq) æ£€æŸ¥åºåˆ—ä¸­çš„æ‰€æœ‰å€¼æ˜¯å¦ä¸åŒ isiterable(x) æ£€æŸ¥xæ˜¯å¦å¯è¿­ä»£ iterate(func, x) é‡å¤å¯¹åŸå§‹è¾“å…¥åº”ç”¨å‡½æ•° join(leftkey, leftseq, rightkey, rightseq[, ...]) åœ¨å…¬å…±å±æ€§ä¸Šè¿æ¥ä¸¤ä¸ªåºåˆ— last(seq) åºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´  mapcat(func, seqs) å¯¹seqsä¸­çš„æ¯ä¸ªåºåˆ—åº”ç”¨funcï¼Œè¿æ¥ç»“æœ merge_sorted(*seqs, **kwargs) åˆå¹¶å’Œæ’åºå·²æ’åºé›†åˆçš„é›†åˆ nth(n, seq) åºåˆ—çš„ç¬¬nä¸ªå…ƒç´  partition(n, seq[, pad]) å°†åºåˆ—åˆ†åŒºä¸ºé•¿åº¦ä¸ºnçš„å…ƒç»„ partition_all(n, seq) å°†æ‰€æœ‰å…ƒç´ åˆ†åŒºä¸ºæœ€å¤šnä¸ªå…ƒç´ çš„å…ƒç»„ peek(seq) æ£€ç´¢åºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´  peekn(n, seq) æ£€ç´¢åºåˆ—çš„ä¸‹nä¸ªå…ƒç´  pluck(ind, seqs[, default]) ä»åºåˆ—ä¸­çš„æ¯ä¸ªé¡¹æå–ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  random_sample(prob, seq[, random_state]) ä»¥æ¦‚ç‡probä»åºåˆ—è¿”å›å…ƒç´  reduceby(key, binop, seq[, init]) æ‰§è¡ŒåŒæ—¶çš„groupbyå’Œreduction remove(predicate, seq) è¿”å›predicate(item)ä¸ºFalseçš„åºåˆ—é¡¹ second(seq) åºåˆ—çš„ç¬¬äºŒä¸ªå…ƒç´  sliding_window(n, seq) é‡å å­åºåˆ—çš„åºåˆ— tail(n, seq) åºåˆ—çš„æœ€ånä¸ªå…ƒç´  take(n, seq) åºåˆ—çš„å‰nä¸ªå…ƒç´  take_nth(n, seq) seqä¸­çš„æ¯ç¬¬nä¸ªé¡¹ topk(k, seq[, key]) æ‰¾å‡ºåºåˆ—çš„kä¸ªæœ€å¤§å…ƒç´  unique(seq[, key]) ä»…è¿”å›åºåˆ—çš„å”¯ä¸€å…ƒç´  Functoolz - å‡½æ•°å·¥å…·#\rå‡½æ•°ç»„åˆå’Œæ“ä½œï¼š\nå‡½æ•° è¯´æ˜ apply(*func_and_args, **kwargs) åº”ç”¨å‡½æ•°å¹¶è¿”å›ç»“æœ complement(func) å°†è°“è¯å‡½æ•°è½¬æ¢ä¸ºå…¶é€»è¾‘è¡¥é›† compose(*funcs) ç»„åˆå‡½æ•°ä»¥ä¸²è”æ“ä½œ compose_left(*funcs) ä»å·¦åˆ°å³ç»„åˆå‡½æ•° curry(*args, **kwargs) å¯¹å¯è°ƒç”¨å‡½æ•°è¿›è¡ŒæŸ¯é‡ŒåŒ– do(func, x) åœ¨xä¸Šè¿è¡Œfuncï¼Œè¿”å›x excepts(exc, func[, handler]) æ•è·å¼‚å¸¸å¹¶åˆ†æ´¾åˆ°å¤„ç†ç¨‹åºçš„åŒ…è£…å™¨ flip([func, a, b]) è°ƒç”¨å‡½æ•°æ—¶ç¿»è½¬å‚æ•° identity(x) æ’ç­‰å‡½æ•° juxt(*funcs) åˆ›å»ºä¸€ä¸ªç”¨ç›¸åŒå‚æ•°è°ƒç”¨å¤šä¸ªå‡½æ•°çš„å‡½æ•° memoize([func, cache, key]) ç¼“å­˜å‡½æ•°ç»“æœä»¥åŠ å¿«æœªæ¥è¯„ä¼° pipe(data, *funcs) é€šè¿‡ä¸€ç³»åˆ—å‡½æ•°ç®¡é“ä¼ é€’å€¼ thread_first(val, *forms) é€šè¿‡ä¸€ç³»åˆ—å‡½æ•°/å½¢å¼çº¿ç¨‹åŒ–å€¼ thread_last(val, *forms) é€šè¿‡ä¸€ç³»åˆ—å‡½æ•°/å½¢å¼çº¿ç¨‹åŒ–å€¼ Dicttoolz - å­—å…¸å·¥å…·#\rå­—å…¸æ“ä½œå‡½æ•°ï¼š\nå‡½æ•° è¯´æ˜ assoc(d, key, value[, factory]) è¿”å›å¸¦æœ‰æ–°é”®å€¼å¯¹çš„æ–°å­—å…¸ assoc_in(d, keys, value[, factory]) è¿”å›å¸¦æœ‰æ–°çš„ã€å¯èƒ½åµŒå¥—çš„é”®å€¼å¯¹çš„æ–°å­—å…¸ dissoc(d, *keys, **kwargs) è¿”å›åˆ é™¤ç»™å®šé”®çš„æ–°å­—å…¸ get_in(keys, coll[, default, no_default]) è¿”å›coll[i0][i1]\u0026hellip;[iX] itemfilter(predicate, d[, factory]) æŒ‰é¡¹è¿‡æ»¤å­—å…¸ä¸­çš„é¡¹ itemmap(func, d[, factory]) å¯¹å­—å…¸çš„é¡¹åº”ç”¨å‡½æ•° keyfilter(predicate, d[, factory]) æŒ‰é”®è¿‡æ»¤å­—å…¸ä¸­çš„é¡¹ keymap(func, d[, factory]) å¯¹å­—å…¸çš„é”®åº”ç”¨å‡½æ•° merge(*dicts, **kwargs) åˆå¹¶å­—å…¸é›†åˆ merge_with(func, *dicts, **kwargs) åˆå¹¶å­—å…¸å¹¶å¯¹åˆå¹¶çš„å€¼åº”ç”¨å‡½æ•° update_in(d, keys, func[, default, factory]) æ›´æ–°åµŒå¥—å­—å…¸å€¼ åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹#\rfrom toolz import * # Itertoolz ç¤ºä¾‹ take(3, [1, 2, 3, 4, 5]) # (1, 2, 3) drop(2, [1, 2, 3, 4, 5]) # (3, 4, 5) first([1, 2, 3]) # 1 last([1, 2, 3]) # 3 # åˆ†ç»„ groupby(lambda x: x % 2, [1, 2, 3, 4, 5]) # {0: [2, 4], 1: [1, 3, 5]} # å‡½æ•°ç»„åˆ add1 = lambda x: x + 1 mul2 = lambda x: x * 2 f = compose(add1, mul2) f(3) # add1(mul2(3)) = 7 # ç®¡é“ pipe(3, mul2, add1) # 7 # å­—å…¸æ“ä½œ d = {\u0026#39;a\u0026#39;: 1, \u0026#39;b\u0026#39;: 2} assoc(d, \u0026#39;c\u0026#39;, 3) # {\u0026#39;a\u0026#39;: 1, \u0026#39;b\u0026#39;: 2, \u0026#39;c\u0026#39;: 3}å¸¸ç”¨å‡½æ•° excepts#\r# ç¤ºä¾‹1ï¼šåŸºæœ¬å¼‚å¸¸æ•è· def divide(x, y): return x / y # åˆ›å»ºä¸€ä¸ªå®‰å…¨çš„é™¤æ³•å‡½æ•°ï¼Œæ•è·ZeroDivisionError safe_divide = excepts(ZeroDivisionError, divide) safe_divide(10, 2) # 5.0 safe_divide(10, 0) # Noneï¼ˆå¼‚å¸¸è¢«æ•è·ï¼‰ # ç¤ºä¾‹2ï¼šè‡ªå®šä¹‰å¼‚å¸¸å¤„ç†ç¨‹åº def handle_error(exc): return f\u0026#34;Error: {exc}\u0026#34; safe_divide_with_handler = excepts(ZeroDivisionError, divide, handle_error) safe_divide_with_handler(10, 2) # 5.0 safe_divide_with_handler(10, 0) # \u0026#34;Error: division by zero\u0026#34;Functoolz è¯¦ç»†ç¤ºä¾‹#\rapply - åº”ç”¨å‡½æ•°#\rfrom toolz import apply def add(x, y): return x + y # ä»å…ƒç»„æˆ–åˆ—è¡¨ä¸­è§£åŒ…å‚æ•° apply(add, [3, 4]) # 7 apply(add, (10, 20)) # 30complement - é€»è¾‘è¡¥é›†#\rfrom toolz import complement def is_even(x): return x % 2 == 0 is_odd = complement(is_even) is_even(4) # True is_odd(4) # False is_odd(5) # Truecompose - å‡½æ•°ç»„åˆï¼ˆä»å³åˆ°å·¦ï¼‰#\rfrom toolz import compose add1 = lambda x: x + 1 mul2 = lambda x: x * 2 # composeä»å³åˆ°å·¦æ‰§è¡Œï¼šå…ˆmul2å†add1 f = compose(add1, mul2) f(3) # add1(mul2(3)) = add1(6) = 7compose_left - å‡½æ•°ç»„åˆï¼ˆä»å·¦åˆ°å³ï¼‰#\rfrom toolz import compose_left add1 = lambda x: x + 1 mul2 = lambda x: x * 2 # compose_leftä»å·¦åˆ°å³æ‰§è¡Œï¼šå…ˆadd1å†mul2 f = compose_left(add1, mul2) f(3) # mul2(add1(3)) = mul2(4) = 8curry - æŸ¯é‡ŒåŒ–#\rfrom toolz import curry @curry def add(x, y, z): return x + y + z # å¯ä»¥é€æ­¥åº”ç”¨å‚æ•° add(1)(2)(3) # 6 add(1, 2)(3) # 6 add(1)(2, 3) # 6do - æ‰§è¡Œå‡½æ•°å¹¶è¿”å›åŸå€¼#\rfrom toolz import do def print_value(x): print(f\u0026#34;Value: {x}\u0026#34;) return x result = do(print_value, 42) # æ‰“å° \u0026#34;Value: 42\u0026#34; print(result) # 42flip - ç¿»è½¬å‚æ•°#\rfrom toolz import flip def subtract(x, y): return x - y flipped_subtract = flip(subtract) subtract(10, 3) # 7 flipped_subtract(10, 3) # -7 (3 - 10)identity - æ’ç­‰å‡½æ•°#\rfrom toolz import identity identity(42) # 42 identity(\u0026#34;hello\u0026#34;) # \u0026#34;hello\u0026#34; identity([1, 2, 3]) # [1, 2, 3] # å¸¸ç”¨äºfilterã€mapç­‰éœ€è¦å‡½æ•°å‚æ•°çš„åœ°æ–¹ list(filter(identity, [0, 1, False, 2, None, 3])) # [1, 2, 3]juxt - å¹¶è¡Œè°ƒç”¨å¤šä¸ªå‡½æ•°#\rfrom toolz import juxt add1 = lambda x: x + 1 mul2 = lambda x: x * 2 square = lambda x: x ** 2 f = juxt(add1, mul2, square) f(3) # (4, 6, 9)memoize - å‡½æ•°ç¼“å­˜#\rfrom toolz import memoize @memoize def fibonacci(n): if n \u0026lt; 2: return n return fibonacci(n-1) + fibonacci(n-2) fibonacci(10) # 55ï¼ˆç»“æœè¢«ç¼“å­˜ï¼‰ fibonacci(10) # 55ï¼ˆç›´æ¥è¿”å›ç¼“å­˜å€¼ï¼‰pipe - ç®¡é“#\rfrom toolz import pipe add1 = lambda x: x + 1 mul2 = lambda x: x * 2 square = lambda x: x ** 2 # ä»å·¦åˆ°å³ä¾æ¬¡åº”ç”¨å‡½æ•° result = pipe(3, add1, mul2, square) # ((3 + 1) * 2) ^ 2 = (4 * 2) ^ 2 = 8 ^ 2 = 64 print(result) # 64thread_first - çº¿ç¨‹ä¼˜å…ˆ#\rfrom toolz import thread_first # å°†å€¼ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™æ¯ä¸ªå‡½æ•° result = thread_first( 3, (lambda x: x + 1), (lambda x: x * 2), (lambda x: x ** 2) ) # ((3 + 1) * 2) ^ 2 = 64 print(result) # 64thread_last - çº¿ç¨‹æœ€å#\rfrom toolz import thread_last # å°†å€¼ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ä¼ é€’ç»™æ¯ä¸ªå‡½æ•° result = thread_last( [1, 2, 3], (map, lambda x: x * 2), list ) # list(map(lambda x: x * 2, [1, 2, 3])) print(result) # [2, 4, 6]å®æˆ˜ç»„åˆç¤ºä¾‹#\rfrom toolz import compose, pipe, curry, memoize, juxt # ç¤ºä¾‹1ï¼šæ•°æ®å¤„ç†ç®¡é“ data = [1, 2, 3, 4, 5] result = pipe( data, (map, lambda x: x * 2), (filter, lambda x: x \u0026gt; 4), list ) print(result) # [6, 8, 10] # ç¤ºä¾‹2ï¼šæŸ¯é‡ŒåŒ–ä¸ç»„åˆ @curry def multiply(x, y): return x * y double = multiply(2) triple = multiply(3) print(double(5)) # 10 print(triple(5)) # 15 # ç¤ºä¾‹3ï¼šå¤šå‡½æ•°å¹¶è¡Œæ‰§è¡Œ get_stats = juxt(min, max, sum, len) numbers = [1, 5, 3, 9, 2] print(get_stats(numbers)) # (1, 9, 20, 5)"},{"id":9,"href":"/Programming-Notes/docs/notes/python/itertools/","title":"Itertools","section":"Python","content":"Python itertools æ¨¡å—æ–¹æ³•ä»‹ç»#\ritertools æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—ç”¨äºé«˜æ•ˆå¾ªç¯çš„è¿­ä»£å™¨å‡½æ•°ï¼Œä»¥ä¸‹æ˜¯ä¸»è¦æ–¹æ³•çš„ç®€å•ä»‹ç»ï¼š\næ— é™è¿­ä»£å™¨#\rcount(start=0, step=1)#\rNOTE\nä» start å¼€å§‹ï¼Œä»¥ step ä¸ºæ­¥é•¿æ— é™è®¡æ•°\ncount(10) â†’ 10, 11, 12, 13, ...cycle(iterable)#\rNOTE\næ— é™é‡å¤è¿­ä»£å™¨ä¸­çš„å…ƒç´ \ncycle(\u0026#39;ABCD\u0026#39;) â†’ A B C D A B C D ...repeat(object[, times])#\rNOTE\né‡å¤å¯¹è±¡æŒ‡å®šæ¬¡æ•°æˆ–æ— é™é‡å¤\nrepeat(10, 3) â†’ 10, 10, 10æœ‰é™è¿­ä»£å™¨#\raccumulate(iterable[, func])#\rNOTE\nè¿”å›ç´¯ç§¯å€¼ï¼ˆé»˜è®¤æ±‚å’Œï¼‰\naccumulate([1,2,3,4,5]) â†’ 1, 3, 6, 10, 15chain(*iterables)#\rNOTE\nå°†å¤šä¸ªè¿­ä»£å™¨è¿æ¥æˆä¸€ä¸ª\nchain(\u0026#39;ABC\u0026#39;, \u0026#39;DEF\u0026#39;) â†’ A B C D E Fchain.from_iterable(iterable)#\rNOTE\nä»å¯è¿­ä»£å¯¹è±¡ä¸­é“¾å¼è¿æ¥\nchain.from_iterable([\u0026#39;ABC\u0026#39;, \u0026#39;DEF\u0026#39;]) â†’ A B C D E Fcompress(data, selectors)#\rNOTE\næ ¹æ®é€‰æ‹©å™¨ç­›é€‰æ•°æ®\ncompress(\u0026#39;ABCDEF\u0026#39;, [1,0,1,0,1,1]) â†’ A C E Fdropwhile(predicate, iterable)#\rNOTE\nå½“ predicate ä¸ºçœŸæ—¶ä¸¢å¼ƒå…ƒç´ ï¼Œç„¶åè¿”å›å‰©ä½™æ‰€æœ‰\ndropwhile(lambda x: x\u0026lt;5, [1,4,6,4,1]) â†’ 6, 4, 1filterfalse(predicate, iterable)#\rNOTE\nè¿”å› predicate ä¸ºå‡çš„å…ƒç´ \nfilterfalse(lambda x: x%2, range(10)) â†’ 0, 2, 4, 6, 8groupby(iterable, key=None)#\rNOTE\næŒ‰é”®åˆ†ç»„ç›¸é‚»çš„é‡å¤å…ƒç´ \n[k for k, g in groupby(\u0026#39;AAAABBBCCDAABBB\u0026#39;)] â†’ A B C D A Bislice(iterable, stop) / islice(iterable, start, stop[, step])#\rNOTE\nå¯¹è¿­ä»£å™¨è¿›è¡Œåˆ‡ç‰‡\nislice(\u0026#39;ABCDEFG\u0026#39;, 2, None) â†’ C D E F Gstarmap(function, iterable)#\rNOTE\nå°†å‚æ•°ä»è¿­ä»£å™¨ä¸­è§£åŒ…ååº”ç”¨å‡½æ•°\nstarmap(pow, [(2,5), (3,2), (10,3)]) â†’ 32, 9, 1000takewhile(predicate, iterable)#\rNOTE\nå½“ predicate ä¸ºçœŸæ—¶è·å–å…ƒç´ \ntakewhile(lambda x: x\u0026lt;5, [1,4,6,4,1]) â†’ 1, 4tee(iterable, n=2)#\rNOTE\nå°†ä¸€ä¸ªè¿­ä»£å™¨æ‹†åˆ†ä¸º n ä¸ªç‹¬ç«‹çš„è¿­ä»£å™¨\na, b = tee(range(5))zip_longest(*iterables, fillvalue=None)#\rNOTE\nç±»ä¼¼äº zipï¼Œä½†ä»¥æœ€é•¿è¿­ä»£å™¨ä¸ºå‡†ï¼Œç”¨ fillvalue å¡«å……\nzip_longest(\u0026#39;ABCD\u0026#39;, \u0026#39;xy\u0026#39;, fillvalue=\u0026#39;-\u0026#39;) â†’ Ax By C- D-ç»„åˆè¿­ä»£å™¨#\rproduct(*iterables, repeat=1)#\rNOTE\nè®¡ç®—ç¬›å¡å°”ç§¯\nproduct(\u0026#39;AB\u0026#39;, repeat=2) â†’ AA AB BA BBpermutations(iterable, r=None)#\rNOTE\nè¿”å›é•¿åº¦ä¸º r çš„æ‰€æœ‰æ’åˆ—\npermutations(\u0026#39;ABCD\u0026#39;, 2) â†’ AB AC AD BA BC BD CA CB CD DA DB DCcombinations(iterable, r)#\rNOTE\nè¿”å›é•¿åº¦ä¸º r çš„æ‰€æœ‰ç»„åˆï¼ˆæŒ‰è¾“å…¥é¡ºåºï¼‰\ncombinations(\u0026#39;ABCD\u0026#39;, 2) â†’ AB AC AD BC BD CDcombinations_with_replacement(iterable, r)#\rNOTE\nè¿”å›åŒ…å«é‡å¤å…ƒç´ çš„ç»„åˆ\ncombinations_with_replacement(\u0026#39;ABC\u0026#39;, 2) â†’ AA AB AC BB BC CC#\r#\r"},{"id":10,"href":"/Programming-Notes/docs/notes/python/modern_python/","title":"Modern Python","section":"Python","content":"pythonç¬”è®°#\rpython æ•ˆç‡æå‡#\ré“¾å¼æ¯”è¾ƒ#\r# ä¼ ç»Ÿå†™æ³• if x \u0026lt; 20 and x \u0026lt; 10 # é“¾å¼æ¯”è¾ƒ if 20 \u0026gt; x \u0026gt; 10è¡¨è¾¾å¼#\r# åˆ—è¡¨è¡¨è¾¾å¼ my_list: list[int] = [expr(x) for x in chain(range(1...5),range(1..5)] # é›†åˆè¡¨è¾¾å¼ my_set: set[str] = {expr(x) for x in my_list} # å­—å…¸è¡¨è¾¾å¼ my_dict: dict[str,int] = {expr(k):expr(v) for k,v in some_dict}chain å‡½æ•°æé«˜å†…å­˜æ•ˆç‡#\r# æƒ°æ€§æ±‚å€¼ chain(iter1,iter2)è£…é¥°å™¨#\r# @wrap å°±æ˜¯è£…é¥°å™¨ @wrap def add(x:int,y:int) -\u0026gt; int: è£…é¥°å™¨å¯ä»¥ç®€å•ç†è§£ä¸ºåœ¨è¿è¡Œå‡½æ•°ä¹‹å‰æ‰§è¡Œä¸å‡½æ•°æ‰§è¡Œç»“æŸä¹‹åæ‰§è¡Œä¸€äº›ç‰¹å®šçš„æ“ä½œã€‚\nè£…é¥°å™¨ä¹Ÿæ˜¯å‡½æ•°ã€‚\nè¢«è£…é¥°å™¨ä¿®é¥°çš„å‡½æ•°å°†ä¼šåœ¨è£…é¥°å™¨å†…éƒ¨æ‰§è¡Œã€‚\nè‡ªå®šä¹‰è£…é¥°å™¨#\rfrom typing import Callable,Any from time import perf_counter,sleep # è®¡æ—¶è£…é¥°å™¨ def time(func:Callable) -\u0026gt; Callable: def wrapper(*args,**kargs) -\u0026gt; Any: print(f\u0026#39;Timing \u0026#34;{func.__name__}\u0026#34;...\u0026#39;) start:float = perf_counter() result:Any = func(*args,**kargs) end:float = perf_counter() print(f\u0026#39;\u0026#34;{func.__name__}\u0026#34; took: {end - start: .4f}s\u0026#39;) return result return wrapper # å‡½æ•°å¼å†™æ³• def time(func:Callable) -\u0026gt; Callable: @wraps(func) def wrapper(*args,**kargs) -\u0026gt; Any:ä¸Šä¸‹æ–‡#\rwith è¯­æ³• ä½¿ç”¨æä¾›çš„ä¸Šä¸‹æ–‡ (@cotextmanager)#\rpython çš„builtinåº“ å†…ç½®çš„contextlibä¸­contextmanagerè£…é¥°å™¨å¯ä»¥å°†ç”Ÿæˆå™¨å˜ä¸ºå…·æœ‰ä¸Šä¸‹æ–‡çš„å‡½æ•°ã€‚\nfrom contextlib import contextmanager @contextmanager def file_handle() -\u0026gt; Geneator[File,None,None]: # å‡½æ•°é€»è¾‘ä¹Ÿå¯ä½¿ç”¨ç±»æ¥æä¾›ä¸€ä¸ªä¸Šä¸‹æ–‡éœ€è¦ç±»çš„å®ç°__enter__ä¸__exit__å‡½æ•°\nclass File: def __enter__(self): def __exit__(self):é¢å‘å¯¹è±¡#\r__furture__#\rç”¨äºåœ¨ç±»æˆ–æšä¸¾ä¸­ä½¿ç”¨è‡ªå·±çš„ç±»å‹\nfrom __future__ import annotationsæšä¸¾#\rWARNING é€šå¸¸æšä¸¾ä¸å¯ä»¥ä½¿ç”¨@dataclassè£…é¥°å™¨ã€‚ä½†æ˜¯åœ¨è¿è¡Œæ—¶ä¸ä¼šæŠ¥é”™ã€‚\n# lsp ä¼šæç¤ºè¿™æ ·ä½¿ç”¨æ˜¯é”™è¯¯çš„ @dataclass class Type(Enum): # æ­£ç¡®ç”¨æ³• class Type(Enum): Some = Noneå®ä¾‹æ–¹æ³•Â·ç±»æ–¹æ³•Â·é™æ€æ–¹æ³•#\rTIP\nç±»æ–¹æ³•æ˜¯é’ˆå¯¹ç±»çš„ï¼Œå®ä¾‹æ–¹æ³•æ˜¯é’ˆå¯¹å®ä¾‹çš„ï¼Œé™æ€æ–¹æ³•æ˜¯é’ˆå¯¹ç±»å’Œå®ä¾‹çš„ã€‚\nç±»æ–¹æ³•å¸¸ç”¨äºæä¾›é¢å¤–çš„æ„é€ å¯¹è±¡çš„æ–¹å¼ï¼Œä½œä¸º__init__æ–¹æ³•çš„è¡¥å……ã€‚\n# é™æ€æ–¹æ³• @staticmethod # ç±»æ–¹æ³• @classmethodå‡½æ•°å¼ç¼–ç¨‹#\rpymonad#\rå‡½æ•°ç»„åˆ#\rCompose#\rä½¿ç”¨Composeçš„å‡½æ•°å¿…é¡»æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥ç”¨Noneä»£æ›¿ã€‚\nfrom pymonad.reader import Compose def add(placeHolder = None) -\u0026gt; int: return 3 Compose(add).then(mul)Pipe#\r"},{"id":11,"href":"/Programming-Notes/docs/notes/rust/lifetime/","title":"Lifetime","section":"Rust","content":"Rust ç”Ÿå‘½å‘¨æœŸ#\rå‡½æ•°ç”Ÿå‘½å‘¨æœŸæ ‡è¯†#\rç”Ÿå‘½å‘¨æœŸæ ‡è¯†çœç•¥è§„åˆ™#\r// æƒ…å†µ1ï¼šæ¯ä¸ªå¼•ç”¨å‚æ•°éƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸ fn first_word(s: \u0026amp;str) -\u0026gt; \u0026amp;str { // è‡ªåŠ¨æ¨å¯¼ä¸º fn first_word\u0026lt;\u0026#39;a\u0026gt;(s: \u0026amp;\u0026#39;a str) -\u0026gt; \u0026amp;\u0026#39;a str let bytes = s.as_bytes(); for (i, \u0026amp;item) in bytes.iter().enumerate() { if item == b\u0026#39; \u0026#39; { return \u0026amp;s[0..i]; } } \u0026amp;s[..] } // æƒ…å†µ2ï¼šå¦‚æœåªæœ‰ä¸€ä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒè¢«èµ‹äºˆæ‰€æœ‰è¾“å‡ºç”Ÿå‘½å‘¨æœŸ fn get_str(s: \u0026amp;str) -\u0026gt; \u0026amp;str { // è‡ªåŠ¨æ¨å¯¼ä¸º fn get_str\u0026lt;\u0026#39;a\u0026gt;(s: \u0026amp;\u0026#39;a str) -\u0026gt; \u0026amp;\u0026#39;a str s } // æƒ…å†µ3ï¼šå¦‚æœæœ‰å¤šä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸï¼Œä½†å…¶ä¸­ä¸€ä¸ªæ˜¯ \u0026amp;self æˆ– \u0026amp;mut selfï¼Œé‚£ä¹ˆ self çš„ç”Ÿå‘½å‘¨æœŸè¢«èµ‹äºˆæ‰€æœ‰è¾“å‡ºç”Ÿå‘½å‘¨æœŸ struct StringWrapper { data: String, } impl StringWrapper { fn get_data(\u0026amp;self) -\u0026gt; \u0026amp;str { // è‡ªåŠ¨æ¨å¯¼ä¸º fn get_data\u0026lt;\u0026#39;a\u0026gt;(\u0026amp;\u0026#39;a self) -\u0026gt; \u0026amp;\u0026#39;a str \u0026amp;self.data } }fn print1(s: \u0026amp;str); // elided fn print2(s: \u0026amp;\u0026#39;_ str); // also elided fn print3\u0026lt;\u0026#39;a\u0026gt;(s: \u0026amp;\u0026#39;a str); // expanded fn debug1(lvl: usize, s: \u0026amp;str); // elided fn debug2\u0026lt;\u0026#39;a\u0026gt;(lvl: usize, s: \u0026amp;\u0026#39;a str); // expanded fn substr1(s: \u0026amp;str, until: usize) -\u0026gt; \u0026amp;str; // elided fn substr2\u0026lt;\u0026#39;a\u0026gt;(s: \u0026amp;\u0026#39;a str, until: usize) -\u0026gt; \u0026amp;\u0026#39;a str; // expanded fn get_mut1(\u0026amp;mut self) -\u0026gt; \u0026amp;mut dyn T; // elided fn get_mut2\u0026lt;\u0026#39;a\u0026gt;(\u0026amp;\u0026#39;a mut self) -\u0026gt; \u0026amp;\u0026#39;a mut dyn T; // expanded fn args1\u0026lt;T: ToCStr\u0026gt;(\u0026amp;mut self, args: \u0026amp;[T]) -\u0026gt; \u0026amp;mut Command; // elided fn args2\u0026lt;\u0026#39;a, \u0026#39;b, T: ToCStr\u0026gt;(\u0026amp;\u0026#39;a mut self, args: \u0026amp;\u0026#39;b [T]) -\u0026gt; \u0026amp;\u0026#39;a mut Command; // expanded fn other_args1\u0026lt;\u0026#39;a\u0026gt;(arg: \u0026amp;str) -\u0026gt; \u0026amp;\u0026#39;a str; // elided fn other_args2\u0026lt;\u0026#39;a, \u0026#39;b\u0026gt;(arg: \u0026amp;\u0026#39;b str) -\u0026gt; \u0026amp;\u0026#39;a str; // expanded fn new1(buf: \u0026amp;mut [u8]) -\u0026gt; Thing\u0026lt;\u0026#39;_\u0026gt;; // elided - preferred fn new2(buf: \u0026amp;mut [u8]) -\u0026gt; Thing; // elided fn new3\u0026lt;\u0026#39;a\u0026gt;(buf: \u0026amp;\u0026#39;a mut [u8]) -\u0026gt; Thing\u0026lt;\u0026#39;a\u0026gt;; // expanded type FunPtr1 = fn(\u0026amp;str) -\u0026gt; \u0026amp;str; // elided type FunPtr2 = for\u0026lt;\u0026#39;a\u0026gt; fn(\u0026amp;\u0026#39;a str) -\u0026gt; \u0026amp;\u0026#39;a str; // expanded type FunTrait1 = dyn Fn(\u0026amp;str) -\u0026gt; \u0026amp;str; // elided type FunTrait2 = dyn for\u0026lt;\u0026#39;a\u0026gt; Fn(\u0026amp;\u0026#39;a str) -\u0026gt; \u0026amp;\u0026#39;a str; // expanded ç”Ÿå‘½å‘¨æœŸå˜å¼‚æ€§#\rfn assign\u0026lt;T\u0026gt;(input: \u0026amp;mut T, val: T) { *input = val; } fn main() { let mut hello: \u0026amp;\u0026#39;static str = \u0026#34;hello\u0026#34;; { let world = String::from(\u0026#34;world\u0026#34;); assign(\u0026amp;mut hello, \u0026amp;world); } println!(\u0026#34;{hello}\u0026#34;); // ä½¿ç”¨åœ¨è¢«é‡Šæ”¾åçš„å€¼ ğŸ˜¿ } TIP\nåå˜(covariant)ã€ä¸å˜(invariant)ã€é€†å˜(contravariant)\nåå˜(covariant)ï¼š\nå¦‚æœTæ˜¯åå˜çš„ä¸”Uæ˜¯Tçš„å­ç±»å‹ï¼Œé‚£ä¹ˆcontainer\u0026lt;T\u0026gt;çš„å­ç±»å‹æ˜¯container\u0026lt;U\u0026gt;ã€‚\né€†å˜(contravariant)ï¼š\nå¦‚æœTæ˜¯é€†å˜çš„ä¸”Uæ˜¯Tçš„å­ç±»å‹ï¼Œé‚£ä¹ˆcontainer\u0026lt;U\u0026gt;çš„å­ç±»å‹æ˜¯container\u0026lt;T\u0026gt;ã€‚\nä¸å˜(invariant)ï¼š\nä¸¤è€…æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚\n\u0026lsquo;a T U \u0026amp;'a T covariant covariant \u0026amp;'a mut T covariant invariant *const T covariant *mut T invariant Box\u0026lt;T\u0026gt; covariant Vec\u0026lt;T\u0026gt; covariant UnsafeCell\u0026lt;T\u0026gt; invariant Cell\u0026lt;T\u0026gt; invariant fn(T) -\u0026gt; U covariant contravariant [T]å’Œ[T;n] covariant std::marker::PhantomData\u0026lt;T\u0026gt; covariant dyn Trait\u0026lt;T\u0026gt; + 'a covariant invariant NOTE\n\u0026amp;'a mut Tä¸­å…³äºTä¸ºä»€ä¹ˆæ˜¯ä¸å˜(invariant)çš„ã€‚å¦‚æœæ˜¯åå˜çš„é‚£ä¹ˆå½“ç¼©å‡äº†ç”Ÿå‘½å‘¨æœŸåå°±ä¼šå‡ºç°æ‚¬å‚æŒ‡é’ˆã€‚\nfn assign_short_string(x: \u0026amp;mut \u0026amp;\u0026#39;short str) { let s = String::from(\u0026#34;short\u0026#34;); *x = \u0026amp;s; // å°†çŸ­ç”Ÿå‘½å‘¨æœŸçš„å­—ç¬¦ä¸²èµ‹å€¼ç»™ *x } // s è¢«ä¸¢å¼ƒï¼Œæ‰€ä»¥ *x å˜æˆäº†æ‚¬å‚æŒ‡é’ˆ fn main() { let mut static_str: \u0026amp;\u0026#39;static str = \u0026#34;hello\u0026#34;; assign_short_string(\u0026amp;mut static_str); // å¦‚æœå…è®¸ï¼Œé‚£ä¹ˆ static_str ä¼šæŒ‡å‘ä¸€ä¸ªå·²é‡Šæ”¾çš„å­—ç¬¦ä¸² println!(\u0026#34;{}\u0026#34;, static_str); // ä½¿ç”¨æ‚¬å‚æŒ‡é’ˆ } é‡å€Ÿç”¨(ReBorrow)#\rTIP\n\u0026amp;'a T å®ç°äº†Copy traitï¼Œ \u0026amp;'a mut T æ²¡æœ‰å®ç°Copy traitã€‚\nlet mut i = 42; let x:\u0026amp;mut i32 = \u0026amp;mut i; let y:\u0026amp;mut i32 = x; // ç­‰ä»·äº let y:\u0026amp;mut i32 = \u0026amp;mut *x; // y é‡å€Ÿç”¨äº†i, åœ¨yå­˜æ´»æ—¶æœŸä¸å¯ä»¥ä½¿ç”¨xä¸iã€‚ "},{"id":12,"href":"/Programming-Notes/docs/notes/rust/rust_iterator_adapters/","title":"Rust Iterator Adapters","section":"Rust","content":"Rust è¿­ä»£å™¨é€‚é…å™¨å®Œæ•´æŒ‡å—#\råŸºç¡€è½¬æ¢é€‚é…å™¨#\rmap - æ˜ å°„è½¬æ¢#\rlet nums = vec![1, 2, 3]; let doubled: Vec\u0026lt;_\u0026gt; = nums.iter().map(|x| x * 2).collect(); // [2, 4, 6] filter - è¿‡æ»¤å…ƒç´ #\rlet nums = vec![1, 2, 3, 4, 5]; let evens: Vec\u0026lt;_\u0026gt; = nums.iter().filter(|x| *x % 2 == 0).collect(); // [2, 4] filter_map - è¿‡æ»¤å¹¶æ˜ å°„#\rlet strs = vec![\u0026#34;1\u0026#34;, \u0026#34;two\u0026#34;, \u0026#34;3\u0026#34;]; let nums: Vec\u0026lt;_\u0026gt; = strs.iter().filter_map(|s| s.parse::\u0026lt;i32\u0026gt;().ok()).collect(); // [1, 3] flat_map - æ‰å¹³åŒ–æ˜ å°„#\rlet words = vec![\u0026#34;hello\u0026#34;, \u0026#34;world\u0026#34;]; let chars: Vec\u0026lt;_\u0026gt; = words.iter().flat_map(|s| s.chars()).collect(); // [\u0026#39;h\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;o\u0026#39;, \u0026#39;w\u0026#39;, \u0026#39;o\u0026#39;, \u0026#39;r\u0026#39;, \u0026#39;l\u0026#39;, \u0026#39;d\u0026#39;] flatten - æ‰å¹³åŒ–åµŒå¥—#\rlet nested = vec![vec![1, 2], vec![3, 4]]; let flat: Vec\u0026lt;_\u0026gt; = nested.into_iter().flatten().collect(); // [1, 2, 3, 4] ç´¢å¼•å’Œæšä¸¾#\renumerate - æ·»åŠ ç´¢å¼•#\rlet letters = vec![\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; let indexed: Vec\u0026lt;_\u0026gt; = letters.iter().enumerate().collect(); // [(0, \u0026#39;a\u0026#39;), (1, \u0026#39;b\u0026#39;), (2, \u0026#39;c\u0026#39;)] zip - ç»„åˆä¸¤ä¸ªè¿­ä»£å™¨#\rlet nums = vec![1, 2, 3]; let letters = vec![\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]; let pairs: Vec\u0026lt;_\u0026gt; = nums.iter().zip(letters.iter()).collect(); // [(1, \u0026#39;a\u0026#39;), (2, \u0026#39;b\u0026#39;), (3, \u0026#39;c\u0026#39;)] unzip - åˆ†ç¦»å…ƒç»„#\rlet pairs = vec![(1, \u0026#39;a\u0026#39;), (2, \u0026#39;b\u0026#39;), (3, \u0026#39;c\u0026#39;)]; let (nums, letters): (Vec\u0026lt;_\u0026gt;, Vec\u0026lt;_\u0026gt;) = pairs.into_iter().unzip(); // nums: [1, 2, 3], letters: [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;] è·³è¿‡å’Œè·å–#\rtake - è·å–å‰ n ä¸ªå…ƒç´ #\rlet nums = vec![1, 2, 3, 4, 5]; let first_three: Vec\u0026lt;_\u0026gt; = nums.iter().take(3).collect(); // [1, 2, 3] take_while - è·å–ç›´åˆ°æ¡ä»¶ä¸æ»¡è¶³#\rlet nums = vec![1, 2, 3, 4, 1, 2]; let result: Vec\u0026lt;_\u0026gt; = nums.iter().take_while(|\u0026amp;\u0026amp;x| x \u0026lt; 4).collect(); // [1, 2, 3] skip - è·³è¿‡å‰ n ä¸ªå…ƒç´ #\rlet nums = vec![1, 2, 3, 4, 5]; let last_two: Vec\u0026lt;_\u0026gt; = nums.iter().skip(3).collect(); // [4, 5] skip_while - è·³è¿‡ç›´åˆ°æ¡ä»¶ä¸æ»¡è¶³#\rlet nums = vec![1, 2, 3, 4, 1, 2]; let result: Vec\u0026lt;_\u0026gt; = nums.iter().skip_while(|\u0026amp;\u0026amp;x| x \u0026lt; 3).collect(); // [3, 4, 1, 2] step_by - æŒ‰æ­¥é•¿è¿­ä»£#\rlet nums = vec![0, 1, 2, 3, 4, 5]; let result: Vec\u0026lt;_\u0026gt; = nums.iter().step_by(2).collect(); // [0, 2, 4] é“¾æ¥å’Œå¾ªç¯#\rchain - è¿æ¥ä¸¤ä¸ªè¿­ä»£å™¨#\rlet a = vec![1, 2, 3]; let b = vec![4, 5, 6]; let combined: Vec\u0026lt;_\u0026gt; = a.iter().chain(b.iter()).collect(); // [1, 2, 3, 4, 5, 6] cycle - æ— é™å¾ªç¯è¿­ä»£å™¨#\rlet nums = vec![1, 2, 3]; let result: Vec\u0026lt;_\u0026gt; = nums.iter().cycle().take(7).collect(); // [1, 2, 3, 1, 2, 3, 1] repeat - æ— é™é‡å¤å•ä¸ªå€¼#\rlet result: Vec\u0026lt;_\u0026gt; = std::iter::repeat(5).take(3).collect(); // [5, 5, 5] repeat_with - æ— é™é‡å¤å‡½æ•°è°ƒç”¨#\rlet mut count = 0; let result: Vec\u0026lt;_\u0026gt; = std::iter::repeat_with(|| { count += 1; count }).take(3).collect(); // [1, 2, 3] æ£€æŸ¥å’ŒæŸ¥æ‰¾#\rinspect - æ£€æŸ¥æ¯ä¸ªå…ƒç´ ï¼ˆè°ƒè¯•ç”¨ï¼‰#\rlet nums = vec![1, 2, 3]; let result: Vec\u0026lt;_\u0026gt; = nums.iter() .inspect(|x| println!(\u0026#34;å¤„ç†: {}\u0026#34;, x)) .map(|x| x * 2) .collect(); // æ‰“å°: å¤„ç†: 1, å¤„ç†: 2, å¤„ç†: 3 // ç»“æœ: [2, 4, 6] find - æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ #\rlet nums = vec![1, 2, 3, 4, 5]; let first_even = nums.iter().find(|\u0026amp;\u0026amp;x| x % 2 == 0); // Some(\u0026amp;2) position - æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ä½ç½®#\rlet nums = vec![1, 2, 3, 4, 5]; let pos = nums.iter().position(|\u0026amp;x| x == 3); // Some(2) rposition - ä»åå‘å‰æŸ¥æ‰¾ä½ç½®#\rlet nums = vec![1, 2, 3, 2, 1]; let pos = nums.iter().rposition(|\u0026amp;x| x == 2); // Some(3) åˆ†åŒºå’Œåˆ†ç»„#\rpartition - æŒ‰æ¡ä»¶åˆ†æˆä¸¤ç»„#\rlet nums = vec![1, 2, 3, 4, 5]; let (evens, odds): (Vec\u0026lt;_\u0026gt;, Vec\u0026lt;_\u0026gt;) = nums.into_iter().partition(|x| x % 2 == 0); // evens: [2, 4], odds: [1, 3, 5] fold - æŠ˜å ï¼ˆç´¯ç§¯ï¼‰#\rlet nums = vec![1, 2, 3, 4]; let sum = nums.iter().fold(0, |acc, x| acc + x); // 10 reduce - å½’çº¦ï¼ˆæ— åˆå§‹å€¼ï¼‰#\rlet nums = vec![1, 2, 3, 4]; let product = nums.iter().reduce(|acc, x| acc * x); // Some(24) scan - æœ‰çŠ¶æ€çš„æ˜ å°„#\rlet nums = vec![1, 2, 3, 4]; let running_sum: Vec\u0026lt;_\u0026gt; = nums.iter().scan(0, |state, x| { *state += x; Some(*state) }).collect(); // [1, 3, 6, 10] åè½¬å’Œæ’åº#\rrev - åè½¬è¿­ä»£å™¨#\rlet nums = vec![1, 2, 3]; let reversed: Vec\u0026lt;_\u0026gt; = nums.iter().rev().collect(); // [3, 2, 1] copied - å¤åˆ¶å¼•ç”¨çš„å€¼#\rlet nums = vec![1, 2, 3]; let copied: Vec\u0026lt;_\u0026gt; = nums.iter().copied().collect(); // [1, 2, 3] (æ‹¥æœ‰æ‰€æœ‰æƒ) cloned - å…‹éš†å¼•ç”¨çš„å€¼#\rlet strings = vec![String::from(\u0026#34;a\u0026#34;), String::from(\u0026#34;b\u0026#34;)]; let cloned: Vec\u0026lt;_\u0026gt; = strings.iter().cloned().collect(); // [String(\u0026#34;a\u0026#34;), String(\u0026#34;b\u0026#34;)] çª—å£å’Œåˆ†å—#\rwindows - æ»‘åŠ¨çª—å£#\rlet nums = vec![1, 2, 3, 4]; let windows: Vec\u0026lt;_\u0026gt; = nums.windows(2).collect(); // [[1, 2], [2, 3], [3, 4]] chunks - å›ºå®šå¤§å°åˆ†å—#\rlet nums = vec![1, 2, 3, 4, 5]; let chunks: Vec\u0026lt;_\u0026gt; = nums.chunks(2).collect(); // [[1, 2], [3, 4], [5]] chunks_exact - ç²¾ç¡®å¤§å°åˆ†å—#\rlet nums = vec![1, 2, 3, 4, 5]; let chunks: Vec\u0026lt;_\u0026gt; = nums.chunks_exact(2).collect(); // [[1, 2], [3, 4]] (ä¸åŒ…å« [5]) rchunks - ä»åå‘å‰åˆ†å—#\rlet nums = vec![1, 2, 3, 4, 5]; let chunks: Vec\u0026lt;_\u0026gt; = nums.rchunks(2).collect(); // [[4, 5], [2, 3], [1]] æ¯”è¾ƒå’Œåˆ¤æ–­#\rall - æ‰€æœ‰å…ƒç´ éƒ½æ»¡è¶³æ¡ä»¶#\rlet nums = vec![2, 4, 6]; let all_even = nums.iter().all(|x| x % 2 == 0); // true any - ä»»æ„å…ƒç´ æ»¡è¶³æ¡ä»¶#\rlet nums = vec![1, 3, 4]; let has_even = nums.iter().any(|x| x % 2 == 0); // true eq - æ¯”è¾ƒä¸¤ä¸ªè¿­ä»£å™¨æ˜¯å¦ç›¸ç­‰#\rlet a = vec![1, 2, 3]; let b = vec![1, 2, 3]; let equal = a.iter().eq(b.iter()); // true ne - æ¯”è¾ƒä¸¤ä¸ªè¿­ä»£å™¨æ˜¯å¦ä¸ç­‰#\rlet a = vec![1, 2, 3]; let b = vec![1, 2, 4]; let not_equal = a.iter().ne(b.iter()); // true lt / le / gt / ge - å­—å…¸åºæ¯”è¾ƒ#\rlet a = vec![1, 2, 3]; let b = vec![1, 2, 4]; let less = a.iter().lt(b.iter()); // true è®¡æ•°å’Œç»Ÿè®¡#\rcount - è®¡æ•°å…ƒç´ ä¸ªæ•°#\rlet nums = vec![1, 2, 3, 4, 5]; let count = nums.iter().count(); // 5 sum - æ±‚å’Œ#\rlet nums = vec![1, 2, 3, 4]; let total: i32 = nums.iter().sum(); // 10 product - æ±‚ç§¯#\rlet nums = vec![1, 2, 3, 4]; let result: i32 = nums.iter().product(); // 24 æœ€å€¼æŸ¥æ‰¾#\rmax - æŸ¥æ‰¾æœ€å¤§å€¼#\rlet nums = vec![1, 5, 3, 2]; let max = nums.iter().max(); // Some(\u0026amp;5) min - æŸ¥æ‰¾æœ€å°å€¼#\rlet nums = vec![1, 5, 3, 2]; let min = nums.iter().min(); // Some(\u0026amp;1) max_by - æŒ‰æ¯”è¾ƒå™¨æŸ¥æ‰¾æœ€å¤§å€¼#\rlet nums = vec![-5, 2, -10, 3]; let max = nums.iter().max_by(|a, b| a.abs().cmp(\u0026amp;b.abs())); // Some(\u0026amp;-10) min_by - æŒ‰æ¯”è¾ƒå™¨æŸ¥æ‰¾æœ€å°å€¼#\rlet nums = vec![-5, 2, -10, 3]; let min = nums.iter().min_by(|a, b| a.abs().cmp(\u0026amp;b.abs())); // Some(\u0026amp;2) max_by_key - æŒ‰é”®å‡½æ•°æŸ¥æ‰¾æœ€å¤§å€¼#\rlet words = vec![\u0026#34;a\u0026#34;, \u0026#34;bbb\u0026#34;, \u0026#34;cc\u0026#34;]; let longest = words.iter().max_by_key(|s| s.len()); // Some(\u0026amp;\u0026#34;bbb\u0026#34;) min_by_key - æŒ‰é”®å‡½æ•°æŸ¥æ‰¾æœ€å°å€¼#\rlet words = vec![\u0026#34;a\u0026#34;, \u0026#34;bbb\u0026#34;, \u0026#34;cc\u0026#34;]; let shortest = words.iter().min_by_key(|s| s.len()); // Some(\u0026amp;\u0026#34;a\u0026#34;) ç‰¹æ®Šæ“ä½œ#\rnth - è·å–ç¬¬ n ä¸ªå…ƒç´ #\rlet nums = vec![1, 2, 3, 4, 5]; let third = nums.iter().nth(2); // Some(\u0026amp;3) last - è·å–æœ€åä¸€ä¸ªå…ƒç´ #\rlet nums = vec![1, 2, 3]; let last = nums.iter().last(); // Some(\u0026amp;3) peekable - å¯é¢„è§ˆä¸‹ä¸€ä¸ªå…ƒç´ #\rlet nums = vec![1, 2, 3]; let mut iter = nums.iter().peekable(); assert_eq!(iter.peek(), Some(\u0026amp;\u0026amp;1)); assert_eq!(iter.next(), Some(\u0026amp;1));fuse - ç¡®ä¿è¿­ä»£å™¨ç»“æŸåä¸å†äº§ç”Ÿå…ƒç´ #\rlet nums = vec![1, 2, 3]; let mut iter = nums.iter().fuse(); // å³ä½¿å¤šæ¬¡è°ƒç”¨ next()ï¼Œç»“æŸåå§‹ç»ˆè¿”å› None by_ref - å€Ÿç”¨è¿­ä»£å™¨#\rlet nums = vec![1, 2, 3, 4, 5]; let mut iter = nums.iter(); let first_two: Vec\u0026lt;_\u0026gt; = iter.by_ref().take(2).collect(); let rest: Vec\u0026lt;_\u0026gt; = iter.collect(); // first_two: [1, 2], rest: [3, 4, 5] æ”¶é›†å’Œæ¶ˆè´¹#\rcollect - æ”¶é›†åˆ°é›†åˆ#\rlet nums = vec![1, 2, 3]; let doubled: Vec\u0026lt;_\u0026gt; = nums.iter().map(|x| x * 2).collect(); // [2, 4, 6] for_each - å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œ#\rlet nums = vec![1, 2, 3]; nums.iter().for_each(|x| println!(\u0026#34;{}\u0026#34;, x)); // æ‰“å°: 1, 2, 3 try_fold - å¯å¤±è´¥çš„æŠ˜å #\rlet nums = vec![1, 2, 3]; let result: Result\u0026lt;i32, \u0026amp;str\u0026gt; = nums.iter().try_fold(0, |acc, \u0026amp;x| { if x \u0026gt; 0 { Ok(acc + x) } else { Err(\u0026#34;è´Ÿæ•°\u0026#34;) } }); // Ok(6) try_for_each - å¯å¤±è´¥çš„éå†#\rlet nums = vec![1, 2, 3]; let result: Result\u0026lt;(), \u0026amp;str\u0026gt; = nums.iter().try_for_each(|\u0026amp;x| { if x \u0026gt; 0 { Ok(()) } else { Err(\u0026#34;è´Ÿæ•°\u0026#34;) } }); // Ok(()) ç»„åˆç¤ºä¾‹#\rå¤æ‚é“¾å¼è°ƒç”¨#\rlet result: i32 = (1..=10) .filter(|x| x % 2 == 0) // å¶æ•° .map(|x| x * x) // å¹³æ–¹ .take(3) // å‰3ä¸ª .sum(); // æ±‚å’Œ // 2Â² + 4Â² + 6Â² = 4 + 16 + 36 = 56 å¤šé‡è¿‡æ»¤å’Œè½¬æ¢#\rlet words = vec![\u0026#34;hello\u0026#34;, \u0026#34;world\u0026#34;, \u0026#34;rust\u0026#34;, \u0026#34;programming\u0026#34;]; let result: Vec\u0026lt;_\u0026gt; = words.iter() .filter(|s| s.len() \u0026gt; 4) .map(|s| s.to_uppercase()) .collect(); // [\u0026#34;HELLO\u0026#34;, \u0026#34;WORLD\u0026#34;, \u0026#34;PROGRAMMING\u0026#34;] åˆ†ç»„ç»Ÿè®¡#\ruse std::collections::HashMap; let words = vec![\u0026#34;apple\u0026#34;, \u0026#34;banana\u0026#34;, \u0026#34;apricot\u0026#34;, \u0026#34;blueberry\u0026#34;]; let grouped: HashMap\u0026lt;char, Vec\u0026lt;\u0026amp;str\u0026gt;\u0026gt; = words.iter() .fold(HashMap::new(), |mut acc, word| { acc.entry(word.chars().next().unwrap()) .or_insert_with(Vec::new) .push(word); acc }); // {\u0026#39;a\u0026#39;: [\u0026#34;apple\u0026#34;, \u0026#34;apricot\u0026#34;], \u0026#39;b\u0026#39;: [\u0026#34;banana\u0026#34;, \u0026#34;blueberry\u0026#34;]} "},{"id":13,"href":"/Programming-Notes/docs/notes/rust/%E5%86%85%E9%83%A8%E5%8F%AF%E5%8F%98%E6%80%A7/","title":"å†…éƒ¨å¯å˜æ€§","section":"Rust","content":"Rust Cellã€RefCellã€unsafeCell#\rä½¿ç”¨æ—¶æœº#\råœ¨ç»“æ„ä½“çš„çŠ¶æ€ä¸å˜ï¼Œä½†æ˜¯éœ€è¦å†…éƒ¨å±æ€§æ”¹å˜æ—¶ã€‚\nCell#\rCelléœ€è¦å®ç°äº†Copy Traitçš„æ•°æ®ç»“æ„æ‰èƒ½è°ƒç”¨å…¶get()æ–¹æ³•ã€‚\nstruct Temp\u0026lt;T\u0026gt; where T:Copy { cache:Cell\u0026lt;T\u0026gt; }struct Temp { cache:Cell\u0026lt;HashMap\u0026lt;int,int\u0026gt;\u0026gt; }è€Œå‘ä¸Šé¢HashMapæ²¡æœ‰å®ç°Copy Traitå¯ä»¥ä½¿ç”¨takeã€‚\nCellæœ€å¥½ä¸è¦è·å–å¼•ç”¨ è·å–å¼•ç”¨æœ€å¥½ä½¿ç”¨RefCell\nRefCell#\rstruct Temp { cache:RefCell\u0026lt;HashMap\u0026lt;int,int\u0026gt;\u0026gt; }RefCellä¼šå°†ç¼–è¯‘æ—¶è¿›è¡Œçš„å¼•ç”¨æ£€æŸ¥å»¶è¿Ÿåˆ°è¿è¡Œæ—¶ï¼Œå¦‚æœè¿è¡Œæ—¶å‘ç”Ÿå¼•ç”¨é”™è¯¯åˆ™ä¼španicã€‚\nç”±äºRefCellå†…éƒ¨é€šè¿‡ç»´æŒä¸€ä¸ªå¼•ç”¨è®¡æ•°åœ¨è¿è¡Œæ—¶è¿›è¡Œå¼•ç”¨æ£€æŸ¥ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ä¸€äº›æ€§èƒ½æŸå¤±ã€‚ å¦‚æœä¸å¸Œæœ›æœ‰è¿™äº›æ€§èƒ½æŸå¤±å¯ä»¥ä½¿ç”¨unsafeCell\nunsafeCell#\rstruct Temp { cache:UnsafeCell\u0026lt;HashMap\u0026lt;int,int\u0026gt;\u0026gt; }é€šè¿‡æŒ‡é’ˆæ“ä½œå¯å˜æ€§ã€‚æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯unsafeçš„ã€‚\n"}]